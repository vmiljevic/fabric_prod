expression 'SAP Internal Resources AT45' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/AT45/"),
		    #"Removed Other Columns4" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom1" = Table.AddColumn(#"Removed Other Columns4", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "MitarbeiterInnen")),
		    #"Expanded Extracted Data2" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Expanded Extracted Data2",{"Name", "Date modified", "Data"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Other Columns2", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28", "Column29", "Column30", "Column31", "Column32", "Column33", "Column34", "Column35", "Column36", "Column37", "Column38", "Column39", "Column40", "Column41", "Column42", "Column43", "Column44", "Column45", "Column46", "Column47", "Column48"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23", "Data.Column24", "Data.Column25", "Data.Column26", "Data.Column27", "Data.Column28", "Data.Column29", "Data.Column30", "Data.Column31", "Data.Column32", "Data.Column33", "Data.Column34", "Data.Column35", "Data.Column36", "Data.Column37", "Data.Column38", "Data.Column39", "Data.Column40", "Data.Column41", "Data.Column42", "Data.Column43", "Data.Column44", "Data.Column45", "Data.Column46", "Data.Column47", "Data.Column48"}),
		    #"Added Custom2" = Table.AddColumn(#"Expanded Data", "File Name", each if [Data.Column1] = "PERNR" then "File Name" else [Name]),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom2", "Refresh Date", each if [Data.Column1] = "PERNR" then "Refresh Date" else [Date modified]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom4",{"Name"}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Removed Columns", {{"Data.Column48", ""}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Replaced Errors1",{"Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns3", [PromoteAllScalars=true]),
		    #"Changed Type7" = Table.TransformColumnTypes(#"Promoted Headers",{{"FunctionalOrgUnit", type text}}),
		    #"Filtered Rows2" = Table.SelectRows(#"Changed Type7", each ([BK] = 45)),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows2",{{"File Name", type text}, {"PERNR", Int64.Type}, {"NACHNAME", type text}, {"VORNAME", type text}, {"TITELAKAD", type text}, {"HC", Int64.Type}, {"AHC", Int64.Type}, {"FTE", type number}, {"BK", Int64.Type}, {"BKAHC", Int64.Type}, {"WERK", Int64.Type}, {"PERSK", type text}, {"ID", Int64.Type}, {"AD", Int64.Type}, {"RESSORT", type text}, {"KOST", type any}, {"KOSTTXT", type text}, {"STEL", Int64.Type}, {"STELTXT", type text}, {"AZGRADE", type text}, {"LEVEL", type text}, {"BKTXT", type text}, {"WERKTXT", type text}, {"SalesF", Int64.Type}, {"Interns", Int64.Type}, {"Appr", Int64.Type}, {"ORGEH", type text}, {"ORGEHTXT", type text}, {"BT", type text}, {"BTTXT", type text}, {"EINTRITT", type date}, {"ZAUSTRITT", type date}, {"ATZVON", type date}, {"ATZVOLLBIS", type date}, {"AUSTRITT", type date}, {"AWART", type text}, {"TELE", Int64.Type}, {"TITELINT", type text}, {"DefAb", type date}, {"BSGRD", type number}, {"MSTBR", type any}, {"GESCHL", type text}, {"USERID", type text}, {"EMAIL", type text}, {"PernrVorg", Int64.Type}, {"NameVorg", type text}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Changed Type","Employees Vienna.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}, {"KOST", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"File Name", "File Name"}, {"PERNR", "Personal Number"}, {"VORNAME", "First Name"}, {"NACHNAME", "Last Name"}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Renamed Columns",{{"USERID", "User ID"}}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Renamed Columns2",{{"GESCHL", "Gender"}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Renamed Columns3",{{"KOST", "Cost Center"}, {"KOSTTXT", "Cost Center Name"}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Renamed Columns4",{{"STELTXT", "Position"}, {"ORGEH", "Department"}, {"ORGEHTXT", "Role Type"}}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Renamed Columns5",{{"BT", "Location"}, {"BTTXT", "Location Name"}}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Renamed Columns6",{{"EINTRITT", "Start Date"}}),
		    #"Reordered Columns6" = Table.ReorderColumns(#"Renamed Columns7",{"File Name", "Month Service", "Personal Number", "First Name", "Last Name", "AHC", "FTE", "BK", "Cost Center", "Cost Center Name", "Position", "Department", "Role Type", "Location", "Location Name", "Start Date", "ZAUSTRITT", "ATZVON", "ATZVOLLBIS", "AUSTRITT", "Gender", "User ID", "TITELAKAD", "HC", "BKAHC", "WERK", "PERSK", "ID", "AD", "RESSORT", "STEL", "AZGRADE", "LEVEL", "BKTXT", "WERKTXT", "SalesF", "Interns", "Appr", "AWART", "TELE", "TITELINT", "DefAb", "BSGRD", "MSTBR", "EMAIL", "PernrVorg", "NameVorg"}),
		    #"Added Custom3" = Table.AddColumn(#"Reordered Columns6", "Year", each Text.End([Month Service], 4)),
		    #"Changed Type8" = Table.TransformColumnTypes(#"Added Custom3",{{"Year", Int64.Type}}),
		    #"Merged Queries" = Table.NestedJoin(#"Changed Type8", {"Personal Number", "Year"}, #"SAP Resource Grades AT45", {"Personal Number", "Year"}, "SAP Resource Grades AT45", JoinKind.LeftOuter),
		    #"Expanded SAP Resource Grades AT45" = Table.ExpandTableColumn(#"Merged Queries", "SAP Resource Grades AT45", {"Grade"}, {"Grade"}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Expanded SAP Resource Grades AT45",{"Year"}),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Removed Columns2", {{"Grade", "Does not exist"}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Errors","Wien","Vienna",Replacer.ReplaceText,{"Location Name"}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Replaced Value1",{{"BK", type text}}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Changed Type2","45","AT45",Replacer.ReplaceText,{"BK"}),
		    #"Renamed Columns8" = Table.RenameColumns(#"Replaced Value2",{{"BK", "Sales Organisation"}}),
		    #"Renamed Columns9" = Table.RenameColumns(#"Renamed Columns8",{{"BKTXT", "Company"}, {"NameVorg", "My HR Manager"}, {"AUSTRITT", "End Date"}}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Renamed Columns9",null,#date(9999, 12, 31),Replacer.ReplaceValue,{"End Date"}),
		    #"Added Custom6" = Table.AddColumn(#"Replaced Value3", "Employee Name", each [First Name] & " "& [Last Name]),
		    #"Merged Queries1" = Table.NestedJoin(#"Added Custom6", {"Personal Number"}, #"AT45 Employee Master Data", {"Personal Number"}, "AT45 Employee Master Data", JoinKind.LeftOuter),
		    #"Expanded AT45 Employee Master Data" = Table.ExpandTableColumn(#"Merged Queries1", "AT45 Employee Master Data", {"Contract Type", "Daily Rate", "Date of Birth"}, {"Contract Type", "Daily Rate", "Date of Birth"}),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Expanded AT45 Employee Master Data",{{"Date of Birth", type date}}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Changed Type3",{{"Daily Rate", Currency.Type}}),
		    #"Lowercased Text" = Table.TransformColumns(#"Changed Type4",{{"EMAIL", Text.Lower, type text}}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Lowercased Text",{{"EMAIL", "Email"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns10",{"Month Service", "Personal Number", "AHC", "FTE", "Sales Organisation", "Cost Center", "Cost Center Name", "Position", "Role Type", "Location Name", "Start Date", "End Date", "Gender", "User ID", "Company", "Email", "DisciplinaryOrgUnit", "FunctionalOrgUnit", "Refresh Date", "My HR Manager", "Grade", "Employee Name", "Contract Type", "Daily Rate", "Date of Birth"}),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Month Service", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type5",{{"FunctionalOrgUnit", "Functional OrgUnit ID"}, {"DisciplinaryOrgUnit", "Disciplinary OrgUnit ID"}}),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Renamed Columns1", "Functional OrgUnit ID", Splitter.SplitTextByEachDelimiter({";"}, QuoteStyle.Csv, false), {"Functional OrgUnit ID.1", "Functional OrgUnit ID.2"}),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"Functional OrgUnit ID.1", type text}, {"Functional OrgUnit ID.2", type text}}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Changed Type6",{{"Functional OrgUnit ID.1", "Functional OrgUnit ID"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns11",{"Functional OrgUnit ID.2"}),
		       #"Changed Type9" = Table.TransformColumnTypes(#"Removed Columns1",{{"Refresh Date", type datetime}})
		in
		    #"Changed Type9"
	lineageTag: f87a748f-c607-4acb-a12b-c72ee68d64d2
	queryGroup: '03_HR SAP'

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

expression 'SAP Internal Resources DE44' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/DE44/")),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom1" = Table.AddColumn(#"Removed Other Columns2", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Extracted Data.Data"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Extracted Data.Data" = Table.ExpandTableColumn(#"Removed Columns", "Extracted Data.Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28", "Column29", "Column30", "Column31", "Column32", "Column33"}, {"Extracted Data.Data.Column1", "Extracted Data.Data.Column2", "Extracted Data.Data.Column3", "Extracted Data.Data.Column4", "Extracted Data.Data.Column5", "Extracted Data.Data.Column6", "Extracted Data.Data.Column7", "Extracted Data.Data.Column8", "Extracted Data.Data.Column9", "Extracted Data.Data.Column10", "Extracted Data.Data.Column11", "Extracted Data.Data.Column12", "Extracted Data.Data.Column13", "Extracted Data.Data.Column14", "Extracted Data.Data.Column15", "Extracted Data.Data.Column16", "Extracted Data.Data.Column17", "Extracted Data.Data.Column18", "Extracted Data.Data.Column19", "Extracted Data.Data.Column20", "Extracted Data.Data.Column21", "Extracted Data.Data.Column22", "Extracted Data.Data.Column23", "Extracted Data.Data.Column24", "Extracted Data.Data.Column25", "Extracted Data.Data.Column26", "Extracted Data.Data.Column27", "Extracted Data.Data.Column28", "Extracted Data.Data.Column29", "Extracted Data.Data.Column30", "Extracted Data.Data.Column31", "Extracted Data.Data.Column32", "Extracted Data.Data.Column33"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Expanded Extracted Data.Data", each ([Extracted Data.Data.Column3] <> null)),
		    #"Added Custom2" = Table.AddColumn(#"Filtered Rows1", "File Name", each if [Extracted Data.Data.Column1] = "PersNr" then "File Name" else [Name]),
		    #"Added Custom7" = Table.AddColumn(#"Added Custom2", "Refresh Date", each if [Extracted Data.Data.Column1] = "PersNr" then "Refresh Date" else [Date modified]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom7",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns1", [PromoteAllScalars=true]),
		    #"Filtered Rows2" = Table.SelectRows(#"Promoted Headers", each ([BuKr] = "DE44")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows2"," Employees Munich.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom",{{"PersNr", "Personal Number"}, {"Vorname", "First Name"}, {"Nachname", "Last Name"}, {"Kostenst.", "Cost Center"}}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Personal Number", Int64.Type}, {"Cost Center", type text}}),
		    #"Added Custom5" = Table.AddColumn(#"Changed Type4", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom5",{"File Name"}),
		    #"Merged Queries" = Table.NestedJoin(#"Removed Columns2", {"Personal Number"}, #"DE44 Employee Master Data", {"Personal Number"}, "DE44 Employee Master Data", JoinKind.LeftOuter),
		    #"Expanded DE44 Employee Master Data" = Table.ExpandTableColumn(#"Merged Queries", "DE44 Employee Master Data", {"Email", "Grade", "Grade 2025", "Gender", "User ID", "Role Type", "Position", "Contract Type", "My HR Manager"}, {"Email", "Grade", "Grade 2025", "Gender", "User ID", "Role Type", "Position", "Contract Type", "My HR Manager"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded DE44 Employee Master Data", "Final Grade", each if  Text.End([Month Service],4) = "2025" then [Grade 2025] else [Grade]),
		    #"Removed Columns3" = Table.RemoveColumns(#"Added Custom4",{"Grade", "Grade 2025"}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Removed Columns3",{{"Final Grade", "Grade"}}),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Renamed Columns7", {{"Grade", "Does not exist"}}),
		    #"Added Custom6" = Table.AddColumn(#"Replaced Errors", "Location Name", each "Munich"),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom6",{{"BuKr", "Sales Organisation"}, {"Kostenstelle", "Cost Center Name"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns",{{"BsGrd", type number}}),
		    #"Divided Column" = Table.TransformColumns(#"Changed Type2", {{"BsGrd", each _ / 100, type number}}),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Divided Column",{{"BsGrd", Currency.Type}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Changed Type5",{{"BsGrd", "FTE"}, {"Personalbereich", "Company"}, {"Anzahl", "AHC"}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Renamed Columns2", {{"Gender", "Does not exists"}}),
		    #"Added Custom10" = Table.AddColumn(#"Replaced Errors3", "End Date", each "31.12.9999"),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Added Custom10",{{"End Date", type date}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type6",{{"GebDatum", "Date of Birth"}, {"Beginn", "Start Date"}}),
		    #"Changed Type7" = Table.TransformColumnTypes(#"Renamed Columns4",{{"Start Date", type date}}),
		    #"Changed Type8" = Table.TransformColumnTypes(#"Changed Type7",{{"Date of Birth", type date}}),
		    #"Added Custom3" = Table.AddColumn(#"Changed Type8", "Daily Rate", each if ([FTE] = 1 or [FTE]=0) then (([Jahresgehalt]/12*13.3))/200 else (([Jahresgehalt]/12*13.3)*(1/[FTE]))/200),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom3",{{"Daily Rate", Currency.Type}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type3",{"Personal Number", "Sales Organisation", "Company", "Cost Center", "Cost Center Name", "Date of Birth", "Start Date", "AHC", "FTE", "Refresh Date", "Month Service", "Employee Name", "Email", "Gender", "User ID", "Role Type", "Position", "Contract Type", "My HR Manager", "Grade", "Location Name", "End Date", "Daily Rate"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Month Service", type date}}),
		    #"Merged Queries1" = Table.NestedJoin(#"Changed Type1", {"Personal Number"}, #"DE44 Employee Master Data", {"Personal Number"}, "DE44 Employee Master Data", JoinKind.LeftOuter),
		    #"Expanded DE44 Employee Master Data1" = Table.ExpandTableColumn(#"Merged Queries1", "DE44 Employee Master Data", {"Disciplinary OrgUnit ID", "Disciplinary OrgUnit ID 2025", "Functional OrgUnit ID"}, {"DE44 Employee Master Data.Disciplinary OrgUnit ID", "DE44 Employee Master Data.Disciplinary OrgUnit ID 2025", "DE44 Employee Master Data.Functional OrgUnit ID"}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Expanded DE44 Employee Master Data1",{{"DE44 Employee Master Data.Disciplinary OrgUnit ID", "Disciplinary OrgUnit ID"}, {"DE44 Employee Master Data.Disciplinary OrgUnit ID 2025", "Disciplinary OrgUnit ID 2025"}, {"DE44 Employee Master Data.Functional OrgUnit ID", "Functional OrgUnit ID"}}),
		    #"Changed Type9" = Table.TransformColumnTypes(#"Renamed Columns6",{{"Refresh Date", type datetime}}),
		    #"Added Custom8" = Table.AddColumn(#"Changed Type9", "Disciplinary OrgUnit ID Corrected", each if Date.Year([Month Service]) = 2025 then [Disciplinary OrgUnit ID 2025] else [Disciplinary OrgUnit ID]),
		    #"Removed Columns5" = Table.RemoveColumns(#"Added Custom8",{"Disciplinary OrgUnit ID", "Disciplinary OrgUnit ID 2025"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns5",{{"Disciplinary OrgUnit ID Corrected", "Disciplinary OrgUnit ID"}})
		in
		    #"Renamed Columns1"
	lineageTag: 98a63a1b-1112-4da1-9c48-9a1be677056b
	queryGroup: '03_HR SAP'

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

expression 'SAP Time Recording Teleworking' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/Telearbeit_AZTECH_2024_V1.xlsx"), null, true),
		    Tabelle1_Sheet = Source{[Item="Tabelle1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Tabelle1_Sheet, [PromoteAllScalars=true]),
		 #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"UhrzeitBeginn", type text}}),
		    #"Trimmed Text" = Table.TransformColumns(#"Changed Type",{{"UhrzeitBeginn", Text.Trim, type text}}),
		    #"Added Custom" = Table.AddColumn(#"Trimmed Text", "UhrzeitBeginCorrected", each Text.PadStart([UhrzeitBeginn],6,"0")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom",{{"UhrzeitBeginCorrected", type time}, {"UhrzeitEnde", type text}}),
		    #"Trimmed Text1" = Table.TransformColumns(#"Changed Type1",{{"UhrzeitEnde", Text.Trim, type text}}),
		    #"Added Custom1" = Table.AddColumn(#"Trimmed Text1", "UhrzeitEndeCorrected", each Text.PadStart([UhrzeitEnde],6,"0")),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom1",{{"UhrzeitEndeCorrected", type time}}),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Changed Type2", {{"UhrzeitEndeCorrected", #time(23, 59, 59)}}),
		    #"Added Custom6" = Table.AddColumn(#"Replaced Errors", "Time Difference 2", each if (([UhrzeitEndeCorrected]-[UhrzeitBeginCorrected]) <> null and [UhrzeitEndeCorrected] > [UhrzeitBeginCorrected]) then (Number.From([UhrzeitEndeCorrected]-[UhrzeitBeginCorrected])*24) else [Stundenanzahl]),
		    #"Added Custom7" = Table.AddColumn(#"Added Custom6", "Time Difference incl. Break", each if ([Time Difference 2] > 5) then ([Time Difference 2] - 0.5) else [Time Difference 2]),
		    #"Rounded Off1" = Table.TransformColumns(#"Added Custom7",{{"Time Difference incl. Break", each Number.Round(_, 2), type number}}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Rounded Off1",{{"Stundenanzahl", type number}}),
		    #"Added Custom4" = Table.AddColumn(#"Changed Type4", "SAP Capacity", each [Time Difference incl. Break]/8),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Added Custom4",{{"SAP Capacity", type number}}),
		    #"Added Custom5" = Table.AddColumn(#"Changed Type5", "Month Date", each Text.Middle(Date.MonthName([DatumBeginn],"en-US"),0,3) & " "& Text.From(Date.Year([DatumBeginn]))),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Added Custom5",{{"PERNR", type text}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type6", "SAP Capacity Check", each [Stundenanzahl]/8),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom2",{{"SAP Capacity Check", type number}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type3",{{"PERNR", "Personal Number"}, {"Nachname", "Last Name"}, {"Vorname", "First Name"}}),
		    #"Grouped Rows" = Table.Group(#"Renamed Columns", {"Personal Number", "First Name", "Last Name", "Month Date"}, {{"Booked in SAP", each List.Sum([SAP Capacity]), type nullable number}}),
		    #"Changed Type7" = Table.TransformColumnTypes(#"Grouped Rows",{{"Month Date", type date}}),
		    #"Filtered Rows" = Table.SelectRows(#"Changed Type7", each ([Personal Number] <> null)),
		    #"Changed Type8" = Table.TransformColumnTypes(#"Filtered Rows",{{"Personal Number", Int64.Type}})
		in
		    #"Changed Type8"
	lineageTag: ffce3a70-1643-44b9-9ac6-bb7194ad8197
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Time Recording Corrections' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/Zeitbuchungen_AZTECH_2024_V1.xlsx"), null, true),
		    Tabelle1_Sheet = Source{[Item="Tabelle1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Tabelle1_Sheet, [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"PERNR", Int64.Type}, {"Datum", type date}, {"monat", Int64.Type}, {"jahr", Int64.Type}, {"mt", type number}, {"Kommen", type time}, {"Gehen", type time}, {"StundenInklPause", type number}, {"NACHN", type text}, {"VORNA", type text}, {"KOSTL", Int64.Type}, {"KOTXT", type text}, {"STELL", Int64.Type}, {"STLTX", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Time", each if [Gehen] > [Kommen] then Number.From([Gehen]-[Kommen])*24 else [StundenInklPause]),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom", "Time incl. Break", each if [Time] > 5 then [Time]-0.5 else [Time]),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Time incl. Break", type number}}),
		    #"Rounded Off" = Table.TransformColumns(#"Changed Type1",{{"Time incl. Break", each Number.Round(_, 2), type number}}),
		    #"Added Custom1" = Table.AddColumn(#"Rounded Off", "SAP Capacity", each [Time incl. Break]/8),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom1",{{"SAP Capacity", type number}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type2", "Month Date", each Text.Middle(Date.MonthName([Datum],"en-US"),0,3) & " "& Text.From(Date.Year([Datum]))),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Added Custom2",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type5",{{"PERNR", "Personalnummer"}}),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Renamed Columns",{{"Personalnummer", type text}}),
		    #"Added Custom3" = Table.AddColumn(#"Changed Type3", "SAP Capacity Check", each [StundenInklPause]/8),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Added Custom3",{{"SAP Capacity Check", type number}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type4",{{"Personalnummer", "Personal Number"}, {"jahr", "Year"}, {"NACHN", "Last Name"}, {"VORNA", "First Name"}}),
		    #"Grouped Rows" = Table.Group(#"Renamed Columns1", {"Personal Number", "First Name", "Last Name", "Month Date"}, {{"Booked in SAP", each List.Sum([SAP Capacity]), type nullable number}}),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Grouped Rows",{{"Personal Number", Int64.Type}})
		in
		    #"Changed Type6"
	lineageTag: fe0d0ff7-6c7f-4ae3-9612-3cd3f171a73b
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP AT45 and DE44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2024_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20AT45%20and%20DE44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: 75e534fd-1fdb-4944-b831-4c24788c9550
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan CZ45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2024_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20CZ45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2024"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: 9a4ea286-b0a6-45ed-a3aa-ddb941492eb3
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan AT45 and DE44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2024_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20AT45%20and%20DE44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2024"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: f09e111a-f6aa-4c83-9c40-d680c625978c
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan CE' =
		let
		    Source = Table.Combine({#"OPEX from BAP Plan AT45 and DE44", #"OPEX from BAP Plan CZ45", #"OPEX from BAP Plan HU44", #"OPEX from BAP Plan SK44 and SK45", #"OPEX from BAP Plan CZ45 2025", #"OPEX from BAP Plan AT45 and DE44 2025", #"OPEX from BAP Plan HU44 2025", #"OPEX from BAP Plan SK44 and SK45 2025", #"OPEX from BAP Plan 2026-2028"})
		in
		    Source
	lineageTag: 44b21698-6269-4e45-b16b-fdbc35b53735
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Sample File (4)' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".xml")),
		    Navigation1 = #"Filtered Rows"{0}[Content]
		in
		    Navigation1
	lineageTag: c4283186-1089-4a85-8043-48c1276fec81
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface\Helper Queries'

	annotation PBI_ResultType = Binary

expression Parameter4 = #"Sample File (4)" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File (4)", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: db518315-37f5-4cb1-a684-69cb5b6b95f4
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface\Helper Queries'

	annotation PBI_ResultType = Exception

	annotation PBI_NavigationStepName = Navigation

expression 'Transform Sample File (4)' =
		let
		    Source = Xml.Tables(Parameter4)
		in
		    Source
	lineageTag: 79d081c2-792a-4470-8b75-276a8483ae67
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface'

	annotation PBI_ResultType = Table

expression 'Transform File (4)' =
		let
		    Source = (Parameter4 as binary) => let
		    Source = Xml.Tables(Parameter4)
		in
		    Source
		in
		    Source
	lineageTag: 378b3ded-9c0d-4810-83f7-3ca457158177
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface\Helper Queries'

	annotation PBI_ResultType = Function

expression 'PPM Time Card Interface New 1' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".xml")),
		    #"Filtered Rows3" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Folder Path], "2025")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows3", each not Text.Contains([Name], "ses_data")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows2", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files1", "Transform File (4)", each #"Transform File (4)"([Content])),
		    #"Renamed Columns1" = Table.RenameColumns(#"Invoke Custom Function1", {"Name", "Source.Name"}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1", {"Source.Name", "Transform File (4)"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File (4)", Table.ColumnNames(#"Transform File (4)"(#"Sample File (4)"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"Source.Name", type text}, {"x_ppm_time_card_interface", type any}, {"Attribute:unload_date", type datetime}}),
		    #"Expanded x_ppm_time_card_interface" = Table.ExpandTableColumn(#"Changed Type", "x_ppm_time_card_interface", {"activity_cluster", "activity_type", "comments", "document_date", "personal_number", "postingdate", "proj_id", "proj_name", "purchase_order", "rec_cc", "reciever_wbs_element", "rep_hours", "sales_order", "sales_order_item", "sap_ack", "sender_cc", "state", "sys_created_by", "sys_created_on", "sys_id", "sys_mod_count", "sys_updated_by", "sys_updated_on", "target_system", "task", "tc", "text", "Attribute:action"}, {"x_ppm_time_card_interface.activity_cluster", "x_ppm_time_card_interface.activity_type", "x_ppm_time_card_interface.comments", "x_ppm_time_card_interface.document_date", "x_ppm_time_card_interface.personal_number", "x_ppm_time_card_interface.postingdate", "x_ppm_time_card_interface.proj_id", "x_ppm_time_card_interface.proj_name", "x_ppm_time_card_interface.purchase_order", "x_ppm_time_card_interface.rec_cc", "x_ppm_time_card_interface.reciever_wbs_element", "x_ppm_time_card_interface.rep_hours", "x_ppm_time_card_interface.sales_order", "x_ppm_time_card_interface.sales_order_item", "x_ppm_time_card_interface.sap_ack", "x_ppm_time_card_interface.sender_cc", "x_ppm_time_card_interface.state", "x_ppm_time_card_interface.sys_created_by", "x_ppm_time_card_interface.sys_created_on", "x_ppm_time_card_interface.sys_id", "x_ppm_time_card_interface.sys_mod_count", "x_ppm_time_card_interface.sys_updated_by", "x_ppm_time_card_interface.sys_updated_on", "x_ppm_time_card_interface.target_system", "x_ppm_time_card_interface.task", "x_ppm_time_card_interface.tc", "x_ppm_time_card_interface.text", "x_ppm_time_card_interface.Attribute:action"}),
		    #"Expanded x_ppm_time_card_interface.tc" = Table.ExpandTableColumn(#"Expanded x_ppm_time_card_interface", "x_ppm_time_card_interface.tc", {"Element:Text", "Attribute:display_value"}, {"x_ppm_time_card_interface.tc.Element:Text", "x_ppm_time_card_interface.tc.Attribute:display_value"}),
		    #"Added Custom1" = Table.AddColumn(#"Expanded x_ppm_time_card_interface.tc", "IsTable", each if [x_ppm_time_card_interface.postingdate] is table then 1 else 0),
		    #"Filtered Rows1" = Table.SelectRows(#"Added Custom1", each ([IsTable] = 1)),
		    #"Expanded x_ppm_time_card_interface.postingdate" = Table.ExpandTableColumn(#"Filtered Rows1", "x_ppm_time_card_interface.postingdate", {"Element:Text"}, {"x_ppm_time_card_interface.postingdate.Element:Text"}),
		    #"Removed Duplicates" = Table.Distinct(#"Expanded x_ppm_time_card_interface.postingdate", {"x_ppm_time_card_interface.tc.Element:Text"}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Removed Duplicates",{"x_ppm_time_card_interface.tc.Element:Text", "x_ppm_time_card_interface.state", "x_ppm_time_card_interface.postingdate.Element:Text"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"x_ppm_time_card_interface.postingdate.Element:Text", type datetime}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Changed Type1",{{"x_ppm_time_card_interface.tc.Element:Text", "Time Card SYSID"}, {"x_ppm_time_card_interface.state", "SAP State"}, {"x_ppm_time_card_interface.postingdate.Element:Text", "SAP Posting Date"}})
		in
		    #"Renamed Columns2"
	lineageTag: dcdbbf59-0284-439b-875d-59ed73b6faec
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'PPM Time Card Interface New 2' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".xml")),
		    #"Filtered Rows3" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Folder Path], "2025")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows3", each not Text.Contains([Name], "ses_data")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows2", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files1", "Transform File (4)", each #"Transform File (4)"([Content])),
		    #"Renamed Columns1" = Table.RenameColumns(#"Invoke Custom Function1", {"Name", "Source.Name"}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1", {"Source.Name", "Transform File (4)"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File (4)", Table.ColumnNames(#"Transform File (4)"(#"Sample File (4)"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"Source.Name", type text}, {"x_ppm_time_card_interface", type any}, {"Attribute:unload_date", type datetime}}),
		    #"Expanded x_ppm_time_card_interface" = Table.ExpandTableColumn(#"Changed Type", "x_ppm_time_card_interface", {"activity_cluster", "activity_type", "comments", "document_date", "personal_number", "postingdate", "proj_id", "proj_name", "purchase_order", "rec_cc", "reciever_wbs_element", "rep_hours", "sales_order", "sales_order_item", "sap_ack", "sender_cc", "state", "sys_created_by", "sys_created_on", "sys_id", "sys_mod_count", "sys_updated_by", "sys_updated_on", "target_system", "task", "tc", "text", "Attribute:action"}, {"x_ppm_time_card_interface.activity_cluster", "x_ppm_time_card_interface.activity_type", "x_ppm_time_card_interface.comments", "x_ppm_time_card_interface.document_date", "x_ppm_time_card_interface.personal_number", "x_ppm_time_card_interface.postingdate", "x_ppm_time_card_interface.proj_id", "x_ppm_time_card_interface.proj_name", "x_ppm_time_card_interface.purchase_order", "x_ppm_time_card_interface.rec_cc", "x_ppm_time_card_interface.reciever_wbs_element", "x_ppm_time_card_interface.rep_hours", "x_ppm_time_card_interface.sales_order", "x_ppm_time_card_interface.sales_order_item", "x_ppm_time_card_interface.sap_ack", "x_ppm_time_card_interface.sender_cc", "x_ppm_time_card_interface.state", "x_ppm_time_card_interface.sys_created_by", "x_ppm_time_card_interface.sys_created_on", "x_ppm_time_card_interface.sys_id", "x_ppm_time_card_interface.sys_mod_count", "x_ppm_time_card_interface.sys_updated_by", "x_ppm_time_card_interface.sys_updated_on", "x_ppm_time_card_interface.target_system", "x_ppm_time_card_interface.task", "x_ppm_time_card_interface.tc", "x_ppm_time_card_interface.text", "x_ppm_time_card_interface.Attribute:action"}),
		    #"Expanded x_ppm_time_card_interface.tc" = Table.ExpandTableColumn(#"Expanded x_ppm_time_card_interface", "x_ppm_time_card_interface.tc", {"Element:Text", "Attribute:display_value"}, {"x_ppm_time_card_interface.tc.Element:Text", "x_ppm_time_card_interface.tc.Attribute:display_value"}),
		    #"Added Custom1" = Table.AddColumn(#"Expanded x_ppm_time_card_interface.tc", "IsTable", each if [x_ppm_time_card_interface.postingdate] is table then 1 else 0),
		    #"Filtered Rows1" = Table.SelectRows(#"Added Custom1", each ([IsTable] = 0)),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows1", {"x_ppm_time_card_interface.tc.Element:Text"}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Removed Duplicates",{"x_ppm_time_card_interface.tc.Element:Text", "x_ppm_time_card_interface.state", "x_ppm_time_card_interface.postingdate"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"x_ppm_time_card_interface.postingdate", type datetime}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type1",{{"x_ppm_time_card_interface.tc.Element:Text", "Time Card SYSID"}, {"x_ppm_time_card_interface.state", "SAP State"}, {"x_ppm_time_card_interface.postingdate", "SAP Posting Date"}})
		in
		    #"Renamed Columns"
	lineageTag: b210c2f0-02ef-4e91-ba4e-7f58c15d6695
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".xml")),
		    #"Filtered Rows1" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Folder Path], "2025")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows1", each Text.Contains([Name], "ses_data")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows2", each [Attributes]?[Hidden]? <> true),
		    #"Filtered Hidden Files2" = Table.SelectRows(#"Filtered Hidden Files1", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files2", "Transform File (2)", each #"Transform File (2)"([Content])),
		    #"Renamed Columns1" = Table.RenameColumns(#"Invoke Custom Function1", {"Name", "Source.Name"}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1", {"Source.Name", "Transform File (2)"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File (2)", Table.ColumnNames(#"Transform File (2)"(#"Sample File (2)"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"Source.Name", type text}, {"x_ppm_ses_data", type any}, {"Attribute:unload_date", type datetime}}),
		    #"Expanded x_ppm_ses_data" = Table.ExpandTableColumn(#"Changed Type", "x_ppm_ses_data", {"comments", "costcenter", "currency", "documentdate", "glaccount", "hours", "internalorderno", "ponumber", "posting_date", "postingdate", "rate_per_hour", "raterole", "resourcegroup", "resourceid", "sap_ack", "state", "sys_created_by", "sys_created_on", "sys_id", "sys_mod_count", "sys_updated_by", "sys_updated_on", "timecard", "wbs", "weekstartdate", "Attribute:action"}, {"x_ppm_ses_data.comments", "x_ppm_ses_data.costcenter", "x_ppm_ses_data.currency", "x_ppm_ses_data.documentdate", "x_ppm_ses_data.glaccount", "x_ppm_ses_data.hours", "x_ppm_ses_data.internalorderno", "x_ppm_ses_data.ponumber", "x_ppm_ses_data.posting_date", "x_ppm_ses_data.postingdate", "x_ppm_ses_data.rate_per_hour", "x_ppm_ses_data.raterole", "x_ppm_ses_data.resourcegroup", "x_ppm_ses_data.resourceid", "x_ppm_ses_data.sap_ack", "x_ppm_ses_data.state", "x_ppm_ses_data.sys_created_by", "x_ppm_ses_data.sys_created_on", "x_ppm_ses_data.sys_id", "x_ppm_ses_data.sys_mod_count", "x_ppm_ses_data.sys_updated_by", "x_ppm_ses_data.sys_updated_on", "x_ppm_ses_data.timecard", "x_ppm_ses_data.wbs", "x_ppm_ses_data.weekstartdate", "x_ppm_ses_data.Attribute:action"}),
		    #"Expanded x_ppm_ses_data.timecard" = Table.ExpandTableColumn(#"Expanded x_ppm_ses_data", "x_ppm_ses_data.timecard", {"Element:Text", "Attribute:display_value"}, {"x_ppm_ses_data.timecard.Element:Text", "x_ppm_ses_data.timecard.Attribute:display_value"}),
		    #"Expanded x_ppm_ses_data.posting_date" = Table.ExpandTableColumn(#"Expanded x_ppm_ses_data.timecard", "x_ppm_ses_data.posting_date", {"Element:Text"}, {"x_ppm_ses_data.posting_date.Element:Text"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Expanded x_ppm_ses_data.posting_date",{{"x_ppm_ses_data.posting_date.Element:Text", "SAP Posting Date"}, {"x_ppm_ses_data.state", "SAP State"}, {"x_ppm_ses_data.timecard.Element:Text", "Time Card SYSID"}}),
		    #"Expanded x_ppm_ses_data.comments" = Table.ExpandTableColumn(#"Renamed Columns", "x_ppm_ses_data.comments", {"Element:Text"}, {"x_ppm_ses_data.comments.Element:Text"}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Expanded x_ppm_ses_data.comments",{"x_ppm_ses_data.comments.Element:Text", "SAP Posting Date", "SAP State", "Time Card SYSID"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Other Columns",{{"x_ppm_ses_data.comments.Element:Text", "Comment"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns2",{{"SAP Posting Date", type date}})
		in
		    #"Changed Type1"
	lineageTag: 287739b2-f1cc-4b64-9a89-9962a58aa144
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Sample File (2)' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".xml")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each Text.Contains([Name], "ses_data")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows2", each [Attributes]?[Hidden]? <> true),
		    Navigation1 = #"Filtered Hidden Files1"{0}[Content]
		in
		    Navigation1
	lineageTag: f1a2abe0-7fa6-4035-a476-4dace31e02ee
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface Externals\Helper Queries'

	annotation PBI_ResultType = Binary

expression Parameter2 = #"Sample File (2)" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File (2)", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: 3ca808ac-b16b-441f-bd83-3d06c9e3175f
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface Externals\Helper Queries'

	annotation PBI_ResultType = Exception

expression 'Transform Sample File (2)' =
		let
		    Source = Xml.Tables(Parameter2)
		in
		    Source
	lineageTag: 48e58af1-34d0-483b-bd0d-e6354b9a60ad
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface Externals'

	annotation PBI_ResultType = Table

expression 'Transform File (2)' =
		let
		    Source = (Parameter2 as binary) => let
		    Source = Xml.Tables(Parameter2)
		in
		    Source
		in
		    Source
	lineageTag: 2ed2cc28-4eaa-43d0-bc8d-8e061a0873a7
	queryGroup: 'Transformation\Transform File from PPM Time Card Interface Externals\Helper Queries'

	annotation PBI_ResultType = Function

expression 'OPEX from BAP SK44 and SK45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2024_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20SK44%20and%20SK45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: aef20250-95e8-4708-b616-cb9853841afc
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources HU44' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/HU44/"),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Name], "-2025")),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows2",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "HU44")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Data.Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Data.Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees HU.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{ "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Removed Columns",{{"Personal Number", "Local ID"}}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Renamed Columns4",{{"Team Name", "Role Type"}, {"Rate Card", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type2",{{"EC ID", "Personal Number"}})
		in
		    #"Renamed Columns1"
	lineageTag: f5394a8a-40a1-4004-b9fc-d8a2905b57c6
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Rate Cards CE' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="RateCardsCE",Kind="Table"]}[Data],
		    #"Renamed Columns" = Table.RenameColumns(GradeandProficiencyLevels_Table,{{"Material", "Title"}, {"Rate Role", "RateRole"}, {"Material Name", "MaterialName"}})
		in
		    #"Renamed Columns"
	lineageTag: ada158af-ffeb-40eb-abc8-b4a948c6f1a3
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP CE' =
		let
		    Source = Table.Combine({#"OPEX from BAP AT45 and DE44", #"OPEX from BAP SK44 and SK45", #"OPEX from BAP CZ45", #"OPEX from BAP HU44", #"OPEX from BAP AT45 and DE44 2025", #"OPEX from BAP SK44 2025", #"OPEX from BAP SK45 2025", #"OPEX from BAP CZ45 2025", #"OPEX from BAP HU44 2025"})
		in
		    Source
	lineageTag: e0856882-3eee-4f99-a277-f95c226593b6
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Projects HU44' =
		let
		
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    pm_projects_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="pm_projects",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(pm_projects_,{{"project_number", "Project Number"}, {"u_profit_center", "Sub Portfolio/ Profit Center"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Demand.1", each [u_ppm_request_envelope_id] & " - " & [demand]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"u_ppm_request_envelope_id", "demand"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"Demand.1", "Demand"}, {"u_bill_code", "Bill Code"}, {"sys_id", "project_sys_id"}, {"primary_portfolio", "Project Portfolio"}, {"u_project_controller", "Project Controller"}, {"project_manager", "Project Manager / Product owner"}, {"u_project_manager_deputee", "Project Manager Deputy / Product Owner Deputy"}, {"u_project_category", "Project Category"}, {"u_project_state", "Project State"}, {"start_date", "Planned start date"}, {"end_date", "Planned end date"}, {"status", "Status"}, {"accounting_master", "Accounting Master"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "WBS", each "NA"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"u_ppm_debtor_relationship", "Debtor"}, {"u_complexity", "Complexity Level"}, {"u_project_sponsor", "Project Sponsor"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns2", "Planned start date 1", each DateTime.FromText([Planned start date], "en-US")),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Planned end date 1", each DateTime.FromText([Planned end date], "en-US")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Planned end date 1", type date}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Changed Type1",{{"Planned start date 1", type date}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Changed Type",{{"u_az_group_project_id", "Group Project ID"}, {"percent_complete", "Percent Complete"}, {"short_description", "Project Name"}, {"u_company_code", "Company Code"}, {"ExportFor", "Exported For"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns5",{"Planned start date", "Planned end date"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns1",{{"Planned start date 1", "Planned start date"}, {"Planned end date 1", "Planned end date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns3", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom2", "AM Key", each [Project Number]&[Exported For]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom5",{"Project Name", "Project Number", "Accounting Master", "project_sys_id", "Project State", "Project Category", "Bill Code", "Debtor", "Sub Portfolio/ Profit Center", "Project Portfolio", "Percent Complete", "Project Manager / Product owner", "Project Manager Deputy / Product Owner Deputy", "Status", "Complexity Level", "Project Controller", "Project Sponsor", "Group Project ID", "Company Code", "Exported For", "Demand", "WBS", "Planned start date", "Planned end date"}),
		    #"Added Custom12" = Table.AddColumn(#"Removed Other Columns", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Changed Type22" = Table.TransformColumnTypes(#"Added Custom12",{{"Planned start date", type date}, {"Planned end date", type date}})
		in
		    #"Changed Type22"
	lineageTag: 6673bcef-6242-4ff7-b98f-ac8db68d54c7
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'PPM Accounting Elements HU44' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    u_ppm_accounting_element_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="u_ppm_accounting_element",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(u_ppm_accounting_element_,{{"u_wbs_element_id", "WBS Element ID"}, {"u_name", "Accounting Element"}, {"accounting_master", "Accounting Master"}, {"u_element_approved", "SAP Approved"}, {"u_expense_type", "Expense Type"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"WBS Element ID", type text}, {"Accounting Element", type text}, {"Accounting Master", type text}, {"SAP Approved", type text}, {"Expense Type", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Project Number", each Text.End([Accounting Master],10)),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Expense Type] = "Capex")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Expense Type", "Project Number"})
		in
		    #"Removed Duplicates"
	lineageTag: 3d9aa062-f669-4604-bf29-d9d58b166534
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Projects CZ45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    pm_projects_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="pm_projects",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(pm_projects_,{{"project_number", "Project Number"}, {"u_profit_center", "Sub Portfolio/ Profit Center"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Demand.1", each [u_ppm_request_envelope_id] & " - " & [demand]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"u_ppm_request_envelope_id", "demand"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"Demand.1", "Demand"}, {"u_bill_code", "Bill Code"}, {"sys_id", "project_sys_id"}, {"primary_portfolio", "Project Portfolio"}, {"u_project_controller", "Project Controller"}, {"project_manager", "Project Manager / Product owner"}, {"u_project_manager_deputee", "Project Manager Deputy / Product Owner Deputy"}, {"u_project_category", "Project Category"}, {"u_project_state", "Project State"}, {"start_date", "Planned start date"}, {"end_date", "Planned end date"}, {"status", "Status"}, {"accounting_master", "Accounting Master"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "WBS", each "NA"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"u_ppm_debtor_relationship", "Debtor"}, {"u_complexity", "Complexity Level"}, {"u_project_sponsor", "Project Sponsor"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns2", "Planned start date 1", each DateTime.FromText([Planned start date], "en-US")),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Planned end date 1", each DateTime.FromText([Planned end date], "en-US")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Planned end date 1", type date}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Changed Type1",{{"Planned start date 1", type date}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Changed Type",{{"u_az_group_project_id", "Group Project ID"}, {"percent_complete", "Percent Complete"}, {"short_description", "Project Name"}, {"u_company_code", "Company Code"}, {"ExportFor", "Exported For"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns5",{"Planned start date", "Planned end date"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns1",{{"Planned start date 1", "Planned start date"}, {"Planned end date 1", "Planned end date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns3", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom2", "AM Key", each [Project Number]&[Exported For]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom5",{"Project Name", "Project Number", "Accounting Master", "project_sys_id", "Project State", "Project Category", "Bill Code", "Debtor", "Sub Portfolio/ Profit Center", "Project Portfolio", "Percent Complete", "Project Manager / Product owner", "Project Manager Deputy / Product Owner Deputy", "Status", "Complexity Level", "Project Controller", "Project Sponsor", "Group Project ID", "Company Code", "Exported For", "Demand", "WBS", "Planned start date", "Planned end date"}),
		    #"Added Custom12" = Table.AddColumn(#"Removed Other Columns", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Changed Type22" = Table.TransformColumnTypes(#"Added Custom12",{{"Planned start date", type date}, {"Planned end date", type date}})
		in
		    #"Changed Type22"
	lineageTag: e2be33cd-853a-4cf2-8531-6eb1e925f858
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources SK45' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/SK45/"),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Name], "-2025")),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows2",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "SK45")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Data.Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Data.Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees SK45.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Changed Type2","15099949","12701066",Replacer.ReplaceValue,{"Personal Number"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","15078475","12720007",Replacer.ReplaceValue,{"Personal Number"})
		in
		    #"Replaced Value2"
	lineageTag: e11d084f-3c42-4fda-b3fc-e33395440333
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources SK44' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/SK44/"),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Name], "-2025")),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows2",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "SK44")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Data.Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Data.Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees SK44.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Date of Birth", type date}, {"End Date", type date}, {"Start Date", type date}, {"Refresh Date", type datetime}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Changed Type2","100821741","12710363",Replacer.ReplaceText,{"Personal Number"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","102057175","12710364",Replacer.ReplaceText,{"Personal Number"})
		in
		    #"Replaced Value2"
	lineageTag: 5c2ce814-29d8-46d0-9932-adc0cdbc34b7
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Projects SK45' =
		let
		
		
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    pm_projects_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="pm_projects",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(pm_projects_,{{"project_number", "Project Number"}, {"u_profit_center", "Sub Portfolio/ Profit Center"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Demand.1", each [u_ppm_request_envelope_id] & " - " & [demand]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"u_ppm_request_envelope_id", "demand"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"Demand.1", "Demand"}, {"u_bill_code", "Bill Code"}, {"sys_id", "project_sys_id"}, {"primary_portfolio", "Project Portfolio"}, {"u_project_controller", "Project Controller"}, {"project_manager", "Project Manager / Product owner"}, {"u_project_manager_deputee", "Project Manager Deputy / Product Owner Deputy"}, {"u_project_category", "Project Category"}, {"u_project_state", "Project State"}, {"start_date", "Planned start date"}, {"end_date", "Planned end date"}, {"status", "Status"}, {"accounting_master", "Accounting Master"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "WBS", each "NA"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"u_ppm_debtor_relationship", "Debtor"}, {"u_complexity", "Complexity Level"}, {"u_project_sponsor", "Project Sponsor"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns2", "Planned start date 1", each DateTime.FromText([Planned start date], "en-US")),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Planned end date 1", each DateTime.FromText([Planned end date], "en-US")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Planned end date 1", type date}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Changed Type1",{{"Planned start date 1", type date}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Changed Type",{{"u_az_group_project_id", "Group Project ID"}, {"percent_complete", "Percent Complete"}, {"short_description", "Project Name"}, {"u_company_code", "Company Code"}, {"ExportFor", "Exported For"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns5",{"Planned start date", "Planned end date"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns1",{{"Planned start date 1", "Planned start date"}, {"Planned end date 1", "Planned end date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns3", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom2", "AM Key", each [Project Number]&[Exported For]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom5",{"Project Name", "Project Number", "Accounting Master", "project_sys_id", "Project State", "Project Category", "Bill Code", "Debtor", "Sub Portfolio/ Profit Center", "Project Portfolio", "Percent Complete", "Project Manager / Product owner", "Project Manager Deputy / Product Owner Deputy", "Status", "Complexity Level", "Project Controller", "Project Sponsor", "Group Project ID", "Company Code", "Exported For", "Demand", "WBS", "Planned start date", "Planned end date"}),
		    #"Added Custom12" = Table.AddColumn(#"Removed Other Columns", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Changed Type22" = Table.TransformColumnTypes(#"Added Custom12",{{"Planned start date", type date}, {"Planned end date", type date}})
		in
		    #"Changed Type22"
	lineageTag: d8f3049f-2b92-4378-869f-0ed3bf8499b1
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Projects SK44' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    pm_projects_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="pm_projects",version=""]}[Data],
		    #"Renamed Columns" = Table.RenameColumns(pm_projects_,{{"project_number", "Project Number"}, {"u_profit_center", "Sub Portfolio/ Profit Center"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Demand.1", each [u_ppm_request_envelope_id] & " - " & [demand]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"u_ppm_request_envelope_id", "demand"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"Demand.1", "Demand"}, {"u_bill_code", "Bill Code"}, {"sys_id", "project_sys_id"}, {"primary_portfolio", "Project Portfolio"}, {"u_project_controller", "Project Controller"}, {"project_manager", "Project Manager / Product owner"}, {"u_project_manager_deputee", "Project Manager Deputy / Product Owner Deputy"}, {"u_project_category", "Project Category"}, {"u_project_state", "Project State"}, {"start_date", "Planned start date"}, {"end_date", "Planned end date"}, {"status", "Status"}, {"accounting_master", "Accounting Master"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "WBS", each "NA"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"u_ppm_debtor_relationship", "Debtor"}, {"u_complexity", "Complexity Level"}, {"u_project_sponsor", "Project Sponsor"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns2", "Planned start date 1", each DateTime.FromText([Planned start date], "en-US")),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Planned end date 1", each DateTime.FromText([Planned end date], "en-US")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Planned end date 1", type date}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Changed Type1",{{"Planned start date 1", type date}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Changed Type",{{"u_az_group_project_id", "Group Project ID"}, {"percent_complete", "Percent Complete"}, {"short_description", "Project Name"}, {"u_company_code", "Company Code"}, {"ExportFor", "Exported For"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns5",{"Planned start date", "Planned end date"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns1",{{"Planned start date 1", "Planned start date"}, {"Planned end date 1", "Planned end date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns3", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom2", "AM Key", each [Project Number]&[Exported For]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom5",{"Project Name", "Project Number", "Accounting Master", "project_sys_id", "Project State", "Project Category", "Bill Code", "Debtor", "Sub Portfolio/ Profit Center", "Project Portfolio", "Percent Complete", "Project Manager / Product owner", "Project Manager Deputy / Product Owner Deputy", "Status", "Complexity Level", "Project Controller", "Project Sponsor", "Group Project ID", "Company Code", "Exported For", "Demand", "WBS", "Planned start date", "Planned end date"}),
		    #"Added Custom12" = Table.AddColumn(#"Removed Other Columns", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Changed Type22" = Table.TransformColumnTypes(#"Added Custom12",{{"Planned start date", type date}, {"Planned end date", type date}})
		in
		    #"Changed Type22"
	lineageTag: e53816f3-3860-4163-b9ce-9cdbdf34357b
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'HR Capacity Parameters' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="HRCapacityParameters",Kind="Table"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(GradeandProficiencyLevels_Table,{{"Annual Capacity in PDs", Int64.Type}, {"Sales Organisation", type text}})
		in
		    #"Changed Type"
	lineageTag: 14c435f2-9045-4398-a667-f0bf00a4bcde
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Group Price List Prices' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/DE1214-6208581/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Folder Path] = "https://allianzms.sharepoint.com/teams/DE1214-6208581/Shared Documents/PRICING/02_Price Lists/2025 price lists/") and ([Extension] = ".xlsx" or [Extension] = ".XLSX")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each Text.Contains([Name], "price")),
		    #"Filtered Rows1" = Table.SelectRows(#"Filtered Rows2", let latest = List.Max(#"Filtered Rows2"[Date created]) in each [Date created] = latest),
		    #"Added Custom1" = Table.AddColumn(#"Filtered Rows1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Price Group prices")),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Added Custom1",{"Extracted Data"}),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Removed Other Columns2", "Extracted Data", {"Data"}, {"Extracted Data.Data"}),
		    #"Expanded Extracted Data.Data" = Table.ExpandTableColumn(#"Expanded Extracted Data", "Extracted Data.Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25"}, {"Extracted Data.Data.Column1", "Extracted Data.Data.Column2", "Extracted Data.Data.Column3", "Extracted Data.Data.Column4", "Extracted Data.Data.Column5", "Extracted Data.Data.Column6", "Extracted Data.Data.Column7", "Extracted Data.Data.Column8", "Extracted Data.Data.Column9", "Extracted Data.Data.Column10", "Extracted Data.Data.Column11", "Extracted Data.Data.Column12", "Extracted Data.Data.Column13", "Extracted Data.Data.Column14", "Extracted Data.Data.Column15", "Extracted Data.Data.Column16", "Extracted Data.Data.Column17", "Extracted Data.Data.Column18", "Extracted Data.Data.Column19", "Extracted Data.Data.Column20", "Extracted Data.Data.Column21", "Extracted Data.Data.Column22", "Extracted Data.Data.Column23", "Extracted Data.Data.Column24", "Extracted Data.Data.Column25"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Expanded Extracted Data.Data", [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"SOrg.", "Sales Organisation"}, {"PG", "Price Group"}, {"Price group (customer)", "Price Group Description"}, {"ind. quantity/value", "Price Type"}, {"UoM", "Price Unit"}, {"per", "Price Quantity"}, {"Unit", "Price Currency"}, {"Profit Ctr", "Profit Centre"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns",{"D", "Clt", "DCh", "CnTy"}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Removed Columns1",{{"Material", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type2", "Material and Sales Organisation", each [Sales Organisation] & "-" & [Material]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom",{"Price Group Description", "Price Type", "Price Quantity", "Price Unit", "Amount", "Price Currency", "Material and Sales Organisation"}),
		    #"Filtered Rows3" = Table.SelectRows(#"Removed Other Columns", each ([Price Group Description] <> null)),
		    #"Pivoted Column" = Table.Pivot(#"Filtered Rows3", List.Distinct(#"Filtered Rows3"[#"Price Group Description"]), "Price Group Description", "Amount", List.Sum),
		    #"Renamed Columns4" = Table.RenameColumns(#"Pivoted Column",{{"inside VAT group", "Price Inside VAT Group"}, {"outside VAT group", "Price Outside VAT Group"}, {"External Market Eur.", "Price External Market"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns4",{"not in use"})
		in
		    #"Removed Columns3"
	lineageTag: 7482e39c-2a3d-4d9d-9500-c8ee19429a9f
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Group Price List Deactivated Materials' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/DE1214-6208581/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Folder Path] = "https://allianzms.sharepoint.com/teams/DE1214-6208581/Shared Documents/PRICING/02_Price Lists/2025 price lists/") and ([Extension] = ".xlsx" or [Extension] = ".XLSX")),
		    #"Filtered Rows3" = Table.SelectRows(#"Filtered Rows", each Text.Contains([Name], "price")),
		    #"Filtered Rows1" = Table.SelectRows(#"Filtered Rows3", let latest = List.Max(#"Filtered Rows3"[Date created]) in each [Date created] = latest),
		    #"Added Custom1" = Table.AddColumn(#"Filtered Rows1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Deactivated materials")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Extracted Data.Data"}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Expanded Extracted Data",{"Extracted Data.Data"}),
		    #"Expanded Extracted Data.Data" = Table.ExpandTableColumn(#"Removed Other Columns", "Extracted Data.Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27"}, {"Extracted Data.Data.Column1", "Extracted Data.Data.Column2", "Extracted Data.Data.Column3", "Extracted Data.Data.Column4", "Extracted Data.Data.Column5", "Extracted Data.Data.Column6", "Extracted Data.Data.Column7", "Extracted Data.Data.Column8", "Extracted Data.Data.Column9", "Extracted Data.Data.Column10", "Extracted Data.Data.Column11", "Extracted Data.Data.Column12", "Extracted Data.Data.Column13", "Extracted Data.Data.Column14", "Extracted Data.Data.Column15", "Extracted Data.Data.Column16", "Extracted Data.Data.Column17", "Extracted Data.Data.Column18", "Extracted Data.Data.Column19", "Extracted Data.Data.Column20", "Extracted Data.Data.Column21", "Extracted Data.Data.Column22", "Extracted Data.Data.Column23", "Extracted Data.Data.Column24", "Extracted Data.Data.Column25", "Extracted Data.Data.Column26", "Extracted Data.Data.Column27"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Expanded Extracted Data.Data", [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"SOrg.", "Sales Organisation"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns",{{"Material", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Material and Sales Organisation", each [Sales Organisation]&"-"&[Material]),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom",{{"Sales Organization", "Sales Organization Name"}, {"ind. quantity/value", "Price Type"}, {"BUn", "Charging Unit"}, {"Profit Ctr", "Profit Centre"}}),
		    #"Filtered Rows2" = Table.SelectRows(#"Renamed Columns3", each ([LS] <> null))
		in
		    #"Filtered Rows2"
	lineageTag: aa6ae80a-50b1-4627-9343-e63d2a3bb2e1
	queryGroup: '05_SAP BAP'

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

expression 'Tax Rates' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="TaxRates",Kind="Table"]}[Data]
		in
		    GradeandProficiencyLevels_Table
	lineageTag: c2943310-3c79-46b2-b4e6-d421fa0b1c8e
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Time Recording CZ45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/CE/2024%20HR%20Time%20Booking%20CZ45.xlsx"), null, true),
		    #"HR Time Booking_Sheet" = Source{[Item="HR Time Booking",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"HR Time Booking_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"HR Number", Int64.Type}, {"Working Hours", type number}, {"Overtime Hours", Int64.Type}, {"Month", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Booked in SAP", each ([Working Hours] )/8),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"Month", "Month Date"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Booked in SAP", "Month Date", "HR Number"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Booked in SAP", type number}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Changed Type1",{"HR Number", "Booked in SAP", "Month Date"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Reordered Columns",{{"HR Number", "Personal Number"}})
		in
		    #"Renamed Columns1"
	lineageTag: d66f062b-f56d-41a2-8c08-1fa1518668eb
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Time Recording SK45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/CE/2024%20HR%20Time%20Booking%20SK45.xlsx"), null, true),
		    #"HR Time Booking_Sheet" = Source{[Item="HR Time Booking",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"HR Time Booking_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"HR Number", Int64.Type}, {"Working Hours", type number}, {"Overtime Hours", Int64.Type}, {"Month", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Booked in SAP", each ([Working Hours] )/8),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"Month", "Month Date"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Booked in SAP", "Month Date", "HR Number"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Booked in SAP", type number}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Changed Type1",{"HR Number", "Booked in SAP", "Month Date"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Reordered Columns",{{"HR Number", "Personal Number"}})
		in
		    #"Renamed Columns1"
	lineageTag: 1aaea69d-853c-4231-b87f-69e1b75f3883
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Time Recording SK44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/CE/2024%20HR%20Time%20Booking%20SK44.xlsx"), null, true),
		    #"HR Time Booking_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"HR Time Booking_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"HR Number", Int64.Type}, {"Working Hours", type number}, {"Overtime Hours", Int64.Type}, {"Month", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Booked in SAP", each ([Working Hours] )/8),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"Month", "Month Date"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Booked in SAP", "Month Date", "HR Number"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Booked in SAP", type number}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Changed Type1",{"HR Number", "Booked in SAP", "Month Date"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Reordered Columns",{{"HR Number", "Personal Number"}})
		in
		    #"Renamed Columns1"
	lineageTag: 7bb638a1-1a83-4b7d-9bd4-1c640be2597a
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Accounting Elements SK45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    u_ppm_accounting_element_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="u_ppm_accounting_element",version=""]}[Data],
		
		
		    #"Renamed Columns" = Table.RenameColumns(u_ppm_accounting_element_,{{"u_wbs_element_id", "WBS Element ID"}, {"u_name", "Accounting Element"}, {"accounting_master", "Accounting Master"}, {"u_element_approved", "SAP Approved"}, {"u_expense_type", "Expense Type"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"WBS Element ID", type text}, {"Accounting Element", type text}, {"Accounting Master", type text}, {"SAP Approved", type text}, {"Expense Type", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Project Number", each Text.End([Accounting Master],10)),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Expense Type] = "Capex")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Expense Type", "Project Number"})
		in
		    #"Removed Duplicates"
	lineageTag: 010bc451-0af8-4ab2-95b0-fdc04684a36c
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Accounting Elements SK44' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    u_ppm_accounting_element_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="u_ppm_accounting_element",version=""]}[Data],
		    #"Renamed Columns" = Table.RenameColumns(u_ppm_accounting_element_,{{"u_wbs_element_id", "WBS Element ID"}, {"u_name", "Accounting Element"}, {"accounting_master", "Accounting Master"}, {"u_element_approved", "SAP Approved"}, {"u_expense_type", "Expense Type"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"WBS Element ID", type text}, {"Accounting Element", type text}, {"Accounting Master", type text}, {"SAP Approved", type text}, {"Expense Type", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Project Number", each Text.End([Accounting Master],10)),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Expense Type] = "Capex")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Expense Type", "Project Number"})
		in
		    #"Removed Duplicates"
	lineageTag: 3fa56033-2f49-42ac-b5ff-977b11bdfef9
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Accounting Elements CZ45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    u_ppm_accounting_element_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="u_ppm_accounting_element",version=""]}[Data],
		
		
		    #"Renamed Columns" = Table.RenameColumns(u_ppm_accounting_element_,{{"u_wbs_element_id", "WBS Element ID"}, {"u_name", "Accounting Element"}, {"accounting_master", "Accounting Master"}, {"u_element_approved", "SAP Approved"}, {"u_expense_type", "Expense Type"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"WBS Element ID", type text}, {"Accounting Element", type text}, {"Accounting Master", type text}, {"SAP Approved", type text}, {"Expense Type", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Project Number", each Text.End([Accounting Master],10)),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Expense Type] = "Capex")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Expense Type", "Project Number"})
		in
		    #"Removed Duplicates"
	lineageTag: 9b5abb0f-5ec6-4fa0-95ae-3097f15bffcb
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards AT' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/02_PPM/Time%20Cards/2024%20Export%20of%20PPM%20TimeCards.xlsx"), null, true),
		    #"PPM Export_Sheet" = Source{[Item="PPM Export",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"PPM Export_Sheet", [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each [Export For] <> null),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Filtered Rows", {{"Department", ""}}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Errors", {{"RG Pillars", ""}}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Errors1", {{"RM", ""}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Replaced Errors2", {{"Line Manager", ""}}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Errors3", {{"Debtor", ""}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"BillCode", ""}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"Company Code", ""}}),
		    #"Added Custom" = Table.AddColumn(#"Replaced Errors6", "Export New", each if [Member Company] = "AZ TECH GmbH Austria" then "DE44" else [Export For]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"Export For"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"Export New", "Export For"}})
		in
		    #"Renamed Columns"
	lineageTag: db8617ed-79ea-42e6-ae8b-01544fb3f674
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards SK44 NEW' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/02_PPM/Time%20Cards/CE/2024%20Export%20of%20PPM%20TimeCards%20SK44.xlsx"), null, true),
		    #"PPM Export_Sheet" = Source{[Item="PPM Export",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"PPM Export_Sheet", [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each [Export For] <> null),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Filtered Rows", {{"Department", ""}}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Errors", {{"RG Pillars", ""}}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Errors1", {{"RM", ""}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Replaced Errors2", {{"Line Manager", ""}}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Errors3", {{"Debtor", ""}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"BillCode", ""}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"Company Code", ""}})
		in
		    #"Replaced Errors6"
	lineageTag: 29bf0ce2-88ee-4bfc-8436-e4bbdb0ca4e9
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards SK45 NEW' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/02_PPM/Time%20Cards/CE/2024%20Export%20of%20PPM%20TimeCards%20SK45.xlsx"), null, true),
		    #"PPM Export_Sheet" = Source{[Item="PPM Export",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"PPM Export_Sheet", [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each [Export For] <> null),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Filtered Rows", {{"Department", ""}}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Errors", {{"RG Pillars", ""}}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Errors1", {{"RM", ""}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Replaced Errors2", {{"Line Manager", ""}}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Errors3", {{"Debtor", ""}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"BillCode", ""}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"Company Code", ""}})
		in
		    #"Replaced Errors6"
	lineageTag: 73e126dc-7bf0-4fe5-b21d-1bd8a8731a8b
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards CZ45 NEW' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/02_PPM/Time%20Cards/CE/2024%20Export%20of%20PPM%20TimeCards%20CZ45.xlsx"), null, true),
		    #"PPM Export_Sheet" = Source{[Item="PPM Export",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"PPM Export_Sheet", [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each [Export For] <> null),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Filtered Rows", {{"Department", ""}}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Errors", {{"RG Pillars", ""}}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Errors1", {{"RM", ""}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Replaced Errors2", {{"Line Manager", ""}}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Errors3", {{"Debtor", ""}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"BillCode", ""}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"Company Code", ""}})
		in
		    #"Replaced Errors6"
	lineageTag: 2f7dcb7c-0ffd-4ee6-b70e-bffc9c6c6570
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards HU44 NEW' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/02_PPM/Time%20Cards/CE/2024%20Export%20of%20PPM%20TimeCards%20HU44.xlsx"), null, true),
		    #"PPM Export_Sheet" = Source{[Item="PPM Export",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"PPM Export_Sheet", [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each [Export For] <> null),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Filtered Rows", {{"Department", ""}}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Errors", {{"RG Pillars", ""}}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Errors1", {{"RM", ""}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Replaced Errors2", {{"Line Manager", ""}}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Errors3", {{"Debtor", ""}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"BillCode", ""}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"Company Code", ""}})
		in
		    #"Replaced Errors6"
	lineageTag: d1517c93-2fb4-45e5-bb43-63619c0abb34
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources CZ45' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/CZ45/"),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows", each not Text.Contains([Name], "-2025")),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows2",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "CZ45")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Data.Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Data.Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees CZ.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Date of Birth", type date}, {"End Date", type date}, {"Start Date", type date}, {"Refresh Date", type datetime}})
		in
		    #"Changed Type2"
	lineageTag: b7477e3e-1d6d-450a-875f-da8d6ad4d783
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Time Recording HU44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Time%20Booking/CE/2024%20HR%20Time%20Booking%20HU44.xlsx"), null, true),
		    #"HR Time Booking_Sheet" = Source{[Item="HR Time Booking",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"HR Time Booking_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"HR Number", type text}, {"Working Hours", type number}, {"Overtime Hours", Int64.Type}, {"Month", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Booked in SAP", each ([Working Hours] )/8),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"Month", "Month Date"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Booked in SAP", "Month Date", "HR Number"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Booked in SAP", type number}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Changed Type1",{"HR Number", "Booked in SAP", "Month Date"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Reordered Columns",{{"HR Number", "Personal Number"}}),
		    #"Merged Queries" = Table.NestedJoin(#"Renamed Columns1", {"Personal Number"}, #"SAP HU Internal Resource IDs", {"Local ID"}, "SAP HU Internal Resource IDs", JoinKind.LeftOuter),
		    #"Expanded SAP HU Internal Resource IDs" = Table.ExpandTableColumn(#"Merged Queries", "SAP HU Internal Resource IDs", {"Local ID", "Personal Number"}, {"Local ID", "Personal Number.1"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Expanded SAP HU Internal Resource IDs",{"Personal Number"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"Personal Number.1", "Personal Number"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns2",{{"Personal Number", Int64.Type}})
		in
		    #"Changed Type2"
	lineageTag: b609414b-1ab4-4b5b-a531-46eae6646598
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP CZ45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2024_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20CZ45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: edc7e6cc-afb4-4c48-9851-7ad7f1f22bb4
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP HU44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2024_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20HU44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: a6ab61e9-43cb-4e8b-8ec6-b760d60021c9
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan HU44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2024_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20HU44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2024"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: 8566a1eb-bcd2-4783-b409-9bd2c71de637
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan SK44 and SK45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2024_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20SK44%20and%20SK45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2024"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: c02a94df-d93e-47a4-94bf-4b640fb689bc
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP AT45 and DE44 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2025/2025_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20AT45%20and%20DE44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: 5337e421-81af-4674-ba06-62947d4b4f4f
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP SK44 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2025/2025_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20SK44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: db94c6aa-a991-497d-8a22-58965090ee8f
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP SK45 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2025/2025_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20SK45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: f3a51d28-2970-470f-b994-709c735e658f
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP CZ45 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2025/2025_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20CZ45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: 4a643aee-a044-46bd-8b88-0b53a1855e8e
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP HU44 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Actuals/2025/2025_Actuals_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20HU44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"CO Document Number", type text}, {"CO Doc Line Item Txt", type text}, {"Cost object", type text}, {"Cost object Name", type text}, {"Cost Element", type text}, {"Cost Element Name", type text}, {"Purchasing document", type text}, {"PO Vendor", type text}, {"Material", type text}, {"Material Name", type text}, {"PO Item Text", type text}, {"Posting period", type text}, {"Fiscal year", type text}, {"Company ID", type text}, {"Doc.number", type text}, {"Customer Cost Center", type text}, {"Offsetting Account", type text}, {"Offsetting Account Name", type text}, {"Origin Object", type text}, {"Origin Object Name", type text}, {"Partner company code", type text}, {"Partner object", type text}, {"Partner object Name", type text}, {"Payer", type text}, {"Payer Name", type text}, {"Reversal ref. number", type text}, {"WBS Element", type text}, {"User Name", type text}, {"Profit center", type text}, {"Profit center Name", type text}, {"Currency", type text}, {"Amount", type any}, {"Quantity", type any}}),
		    #"Removed Top Rows" = Table.Skip(#"Changed Type",2),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Top Rows",{{"Amount", Currency.Type}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Fiscal year] &"-" &[Posting period]),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type2",{{"Amount", "Amount Acutals"}})
		in
		    #"Renamed Columns"
	lineageTag: a8f99c3e-c3f0-4639-a871-208836dd79a7
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan CZ45 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2025/2025_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20CZ45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2025"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor Name", "Payer Name"}, {"Debtor", "Payer"}})
		in
		    #"Renamed Columns1"
	lineageTag: de08208d-78bb-46ab-97ef-089886a707e0
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan AT45 and DE44 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2025/2025_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20AT45%20and%20DE44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2025"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: 663de370-cbda-4d9a-bbaf-2692b03133cd
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan HU44 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2025/2025_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20HU44.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2025"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor Name", "Payer Name"}, {"Debtor", "Payer"}})
		in
		    #"Renamed Columns1"
	lineageTag: def01044-6263-4fce-b6fd-57ce3b3682b7
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan SK44 and SK45 2025' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/Plan/2025/2025_Plan_All%20Line%20Items%20BAP%20CEE%20Comp%20Codes%20SK44%20and%20SK45.xlsx"), null, true),
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars=true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers",3),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Top Rows", {"12", "11", "10", "9", "8", "7", "6", "5", "1", "2", "3", "4"}, "Attribute", "Value"),
		    #"Added Custom" = Table.AddColumn(#"Unpivoted Only Selected Columns", "Month Date", each [Attribute]&"/2025"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		in
		    #"Renamed Columns1"
	lineageTag: 8c18ee82-362e-40ad-99e8-0ae045d0c652
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards AT 2025' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"8f7ec259-5325-4b20-bbbe-e8b3dbee634b" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="69206ad1-b68c-4cc0-91dd-3f7cac7c9d51"]}[Data],
		    time_cards_ = #"8f7ec259-5325-4b20-bbbe-e8b3dbee634b"{[entity="time_cards",version=""]}[Data],
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_at45_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Merged Queries2" = Table.NestedJoin(#"Merged Queries1", {"SYSID"}, #"PPM Time Card Interface Externals 2025 AT45", {"Time Card SYSID"}, "PPM Time Card Interface Externals 2025 AT45", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries2", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Expanded PPM Time Card Interface Externals 2025 AT45" = Table.ExpandTableColumn(#"Expanded extrernal_rate_cards", "PPM Time Card Interface Externals 2025 AT45", {"rate_per_hour"}, {"PPM Time Card Interface Externals 2025 AT45.rate_per_hour"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded PPM Time Card Interface Externals 2025 AT45",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> null),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}}),
		    #"Removed Columns7" = Table.RemoveColumns(#"Renamed Columns15",{"Activity Cluster", "Task"}),
		    #"Renamed Columns17" = Table.RenameColumns(#"Removed Columns7",{{"u_activity_cluster", "Activity Cluster"}, {"task", "Task"}}),
		    #"Removed Columns8" = Table.RemoveColumns(#"Renamed Columns17",{"Res Plan Name"}),
		    #"Renamed Columns18" = Table.RenameColumns(#"Removed Columns8",{{"resource_plan_name", "Res Plan Name"}}),
		    #"Removed Columns9" = Table.RemoveColumns(#"Renamed Columns18",{"Project Task Name"}),
		    #"Renamed Columns19" = Table.RenameColumns(#"Removed Columns9",{{"task_name", "Project Task Name"}, {"PPM Time Card Interface Externals 2025 AT45.rate_per_hour", "Ext Rate Value New"}}),
		    #"Added Custom39" = Table.AddColumn(#"Renamed Columns19", "Ext Rate Value Final", each if [Ext Rate Value New] <> null then [Ext Rate Value New]  else [Ext Rate Value]),
		    #"Removed Columns10" = Table.RemoveColumns(#"Added Custom39",{"Ext Rate Value", "Ext Rate Value New"}),
		    #"Renamed Columns20" = Table.RenameColumns(#"Removed Columns10",{{"Ext Rate Value Final", "Ext Rate Value"}})
		in
		    #"Renamed Columns20"
	lineageTag: 5cf59841-f7f0-492a-8130-cd229e6e29f4
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards SK44 2025' = ```
		let
		 
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"000619c4-b43d-4a59-83ba-dd43dc183b24" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="000619c4-b43d-4a59-83ba-dd43dc183b24"]}[Data],
		    time_cards_ = #"000619c4-b43d-4a59-83ba-dd43dc183b24"{[entity="time_cards",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects SK44", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_sk44_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Merged Queries2" = Table.NestedJoin(#"Merged Queries1", {"SYSID"}, #"PPM Time Card Interface Externals 2025 SK44", {"Time Card SYSID"}, "PPM Time Card Interface Externals 2025 SK44", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries2", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Expanded PPM Time Card Interface Externals 2025 SK44" = Table.ExpandTableColumn(#"Expanded extrernal_rate_cards", "PPM Time Card Interface Externals 2025 SK44", {"rate_per_hour"}, {"rate_per_hour"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded PPM Time Card Interface Externals 2025 SK44",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> ""),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}, {"rate_per_hour", "Ext Rate Value New"}}),
		    #"Added Custom39" = Table.AddColumn(#"Renamed Columns15", "Ext Rate Value Final", each if [Ext Rate Value New] <> null then [Ext Rate Value New] else [Ext Rate Value]),
		    #"Removed Columns7" = Table.RemoveColumns(#"Added Custom39",{"Ext Rate Value", "Ext Rate Value New"}),
		    #"Renamed Columns17" = Table.RenameColumns(#"Removed Columns7",{{"Ext Rate Value Final", "Ext Rate Value"}})
		in
		    #"Renamed Columns17"
		```
	lineageTag: a10efe41-5955-483b-a185-091f34fb057a
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards SK45 2025' = ```
		let
		 
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"5131d01f-bc3e-4851-bdb7-8c8e29e26fc0" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="5131d01f-bc3e-4851-bdb7-8c8e29e26fc0"]}[Data],
		    time_cards_ = #"5131d01f-bc3e-4851-bdb7-8c8e29e26fc0"{[entity="time_cards",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects SK45", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_sk45_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded extrernal_rate_cards",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> ""),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}})
		in
		    #"Renamed Columns15"
		```
	lineageTag: 60c4183b-1bf6-4ce2-933d-6aaa9c84be6c
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards HU44 2025' = ```
		let
		 
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"c809b6fe-8179-4bcb-970b-3f2a896ef259" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="c809b6fe-8179-4bcb-970b-3f2a896ef259"]}[Data],
		    time_cards_ = #"c809b6fe-8179-4bcb-970b-3f2a896ef259"{[entity="time_cards",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects HU44", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_hu44_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded extrernal_rate_cards",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> ""),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}})
		in
		    #"Renamed Columns15"
		```
	lineageTag: f2683b9b-cffe-42b0-8130-775c0728311b
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards CZ45 2025' = ```
		let
		 
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"e272784a-497e-40f5-95bd-98bc8c19e622" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="e272784a-497e-40f5-95bd-98bc8c19e622"]}[Data],
		    time_cards_ = #"e272784a-497e-40f5-95bd-98bc8c19e622"{[entity="time_cards",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects CZ45", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_cz45_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded extrernal_rate_cards",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> ""),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}})
		in
		    #"Renamed Columns15"
		```
	lineageTag: f4289072-7a3e-4a7b-9930-ec7af13ce24a
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025' =
		let
		    Source = Table.Combine({#"PPM Time Card Interface 2025 SK44", #"PPM Time Card Interface 2025 AT45", #"PPM Time Card Interface 2025 HU44", #"PPM Time Card Interface 2025 SK45", #"PPM Time Card Interface 2025 CZ45", #"PPM Time Card Interface 2025 DE44"})
		in
		    Source
	lineageTag: 0216f7c2-14d3-4833-a198-67e2322c003b
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 AT45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"64bf773d-aa10-44ca-88c5-f01597de345a" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="64bf773d-aa10-44ca-88c5-f01597de345a"]}[Data],
		    time_card_interface_externals_ = #"64bf773d-aa10-44ca-88c5-f01597de345a"{[entity="time_card_interface_externals",version=""]}[Data],
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Removed Duplicates" = Table.Distinct(#"Renamed Columns1", {"Time Card SYSID", "SAP State"})
		in
		    #"Removed Duplicates"
	lineageTag: dc8ef95f-1ba6-4b0c-8836-76c463b5aac9
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Customer Contacts' =
		let
		    Source = SharePoint.Tables("https://allianzms.sharepoint.com/teams/AT0090-2759670/Sales/", [Implementation=null, ApiVersion=15]),
		    #"d3b14878-b8c7-4704-ba8e-9f046194b24d" = Source{[Id="d3b14878-b8c7-4704-ba8e-9f046194b24d"]}[Items],
		    #"Removed Other Columns" = Table.SelectColumns(#"d3b14878-b8c7-4704-ba8e-9f046194b24d",{"OrderNumberNameId", "ContactPersonId", "ContactPersonStringId", "ContactRole", "Title", "OrderNumberName", "ContactPerson"}),
		    #"Expanded ContactPerson" = Table.ExpandRecordColumn(#"Removed Other Columns", "ContactPerson", {"Title", "EMail"}, {"ContactPerson.Title", "ContactPerson.EMail"}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Expanded ContactPerson",{"OrderNumberNameId", "ContactRole", "Title", "ContactPerson.Title", "ContactPerson.EMail"})
		in
		    #"Removed Other Columns1"
	lineageTag: bb88cafb-07a8-47df-8434-6fb238f1a2c5
	queryGroup: '02_Sales Lists'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Customer Order Items' =
		let
		    Source = SharePoint.Tables("https://allianzms.sharepoint.com/teams/AT0090-2759670/Sales/", [Implementation=null, ApiVersion=15]),
		    #"51cee2fa-4294-4cac-8b09-fa6465739c62" = Source{[Id="51cee2fa-4294-4cac-8b09-fa6465739c62"]}[Items],
		    #"Removed Other Columns" = Table.SelectColumns(#"51cee2fa-4294-4cac-8b09-fa6465739c62",{"Id", "OrderNumberNameId", "MaterialId", "Title", "PlanningWBS", "TotalPlannedValue", "DurationinMonths", "QuantityperMonth", "TotalEstimatedValue", "QuoteLineID", "GuidedBuyingID", "SAPMMPONumber", "ReceiverWBSorCC", "ReceiverProfitCenter", "SenderProfitCenter", "SenderRevenueAccount", "SenderChargingAccount", "SalesOrganisation", "Tradingpartner", "JanActual", "FebActual", "MarActual", "AprActual", "MayActual", "JunActual", "JulActual", "AugActual", "SepActual", "OctActual", "NovActual", "DecActual", "ActualTotalPDs", "ActualTotalAmount", "InvoiceStatus", "SPrice"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Other Columns",{{"TotalPlannedValue", Currency.Type}, {"TotalEstimatedValue", type text}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Changed Type",".",",",Replacer.ReplaceText,{"TotalEstimatedValue"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"TotalEstimatedValue", type number}})
		in
		    #"Changed Type1"
	lineageTag: ac4dd00f-3089-459f-a8f5-7d81a713f8c0
	queryGroup: '02_Sales Lists'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'Customer Orders' =
		let
		    Source = SharePoint.Tables("https://allianzms.sharepoint.com/teams/AT0090-2759670/Sales/", [Implementation=null, ApiVersion=15]),
		    #"495e5c2a-bcb2-4240-9167-5adb1cc0203a" = Source{[Id="495e5c2a-bcb2-4240-9167-5adb1cc0203a"]}[Items],
		    #"Expanded SalesContact" = Table.ExpandRecordColumn(#"495e5c2a-bcb2-4240-9167-5adb1cc0203a", "SalesContact", {"FirstName", "LastName"}, {"SalesContact.FirstName", "SalesContact.LastName"}),
		    #"Added Custom" = Table.AddColumn(#"Expanded SalesContact", "Sales Contact", each [SalesContact.FirstName] & " " &[SalesContact.LastName]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Id", Int64.Type}, {"PlannedAmount", Currency.Type}, {"EstimatedAmount", Currency.Type}, {"ActualAmount", Currency.Type}, {"ForecastedAmount", Currency.Type}, {"ForecastedvsEstimatedAmount", Currency.Type}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type",{"Id", "Title", "Status", "CustomerName", "DebtorNumber", "CustomerGroup", "CustomerSubgroup", "PlannedAmount", "EstimatedAmount", "ActualAmount", "ForecastedAmount", "DemandID", "ProjectID", "OrderType", "PPMProjectType", "PPMStatus", "UsingExternals", "ExternalProvider", "DocumentsFolder", "StartDate", "EndDate", "Remarks", "SalesContactId", "SalesContactStringId", "InvoicingContactId", "InvoicingContactStringId", "ProcurementContactId", "ProcurementContactStringId", "RicoCategory", "Order2023", "OrderNumberName", "OrderItems", "CustomerContacts", "StatusL", "EmailFolder", "DebtorNumberL", "CustomerNameL", "CustomerGroupL", "CustomerSubgroupL", "QuoteID", "Created", "OrderNumber", "CountryCode", "Sales Contact"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Other Columns",{{"CountryCode", "Country Code"}})
		in
		    #"Renamed Columns"
	lineageTag: c1cb1066-f0ba-4a0a-9d2c-24182a4f830b
	queryGroup: '02_Sales Lists'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'Customer Offerings' =
		let
		    Source = SharePoint.Tables("https://allianzms.sharepoint.com/teams/AT0090-2759670/Sales/", [Implementation=null, ApiVersion=15]),
		    #"d3b14878-b8c7-4704-ba8e-9f046194b24d" = Source{[Id="c38dcd98-1a6a-4d19-869f-64c11cd53c08"]}[Items],
		    #"Removed Other Columns" = Table.SelectColumns(#"d3b14878-b8c7-4704-ba8e-9f046194b24d",{"Id", "Title", "MaterialName", "InvoiceText", "Price", "UnitType", "PriceType", "ProfitCenter", "ServiceOfferingID", "BusinessserviceID", "Category", "Status", "RateRole", "MaterialName0", "ServiceDeliveryHomebase0", "DeliveryModel", "ServiceCluster", "ServiceClass", "ServicePackage", "ProfitCenterName", "CostCenter", "Provider", "Vertical", "PPMProjectNecesary"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Other Columns",{{"MaterialName", "Service Offering Name"}, {"MaterialName0", "MaterialName"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"Price", Currency.Type}})
		in
		    #"Changed Type"
	lineageTag: 83700664-9042-4c8c-b654-93fca852592c
	queryGroup: '02_Sales Lists'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List' =
		let
		    Source = Table.Combine({#"Organizational Unit List Last Month", #"Organizational Unit List Monthly", #"Organizational Unit List Monthly AT Mar", #"Organizational Unit List Monthly AT Feb", #"Organizational Unit List Monthly AT Jan"}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"Current Month", "Check", "Functional Child Departments - simulated"}),
		    #"Merged Queries" = Table.NestedJoin(#"Removed Columns", {"Parent Org Unit ID Composite"}, #"Organizational Unit List Parent Check", {"Org Unit ID Composite"}, "Organizational Unit List Parent Check", JoinKind.LeftOuter),
		    #"Expanded Organizational Unit List Parent Check" = Table.ExpandTableColumn(#"Merged Queries", "Organizational Unit List Parent Check", {"Org Unit ID Composite"}, {"Organizational Unit List Parent Check.Org Unit ID Composite"}),
		    #"Added Custom" = Table.AddColumn(#"Expanded Organizational Unit List Parent Check", "ShowRow", each if [Parent Org Unit ID Composite] <> null and [Organizational Unit List Parent Check.Org Unit ID Composite] = null then 0 else 1),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([ShowRow] = 1)),
		    #"Removed Other Columns" = Table.SelectColumns(#"Filtered Rows",{"Entity", "Name of Org.Unit (dep. long name)", "Org Unit ID (Department ID)", "Name of Manager (last name)", "Name of Manager (first name)", "Manager Employee ID", "Manager email", "Parent Org Unit ID", "Cost Center", "L-1/L-2", "L-1/L-3", "L-1/L-4", "OrgUnit type", "In scope for Functional view", "In scope for disciplinary view", "Unique_ID", "Comment", "Functional Child Departments - original", "Service Month", "Org Unit ID Composite", "Parent Org Unit ID Composite"}),
		    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns", {"Org Unit ID Composite"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Removed Duplicates", each ([Org Unit ID Composite] <> null))
		in
		    #"Filtered Rows1"
	lineageTag: 8218c199-662c-49eb-8b9d-1edd5ce025d8
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Budget Report Vendors' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi", [ApiVersion = 15]),
		    #"Filtered Rows4" = Table.SelectRows(Source, each Text.Contains([Folder Path], "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/06_Budget Demand/")),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Filtered Rows4",{"Content"}),
		    #"Added Custom1" = Table.AddColumn(#"Removed Other Columns2", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Extracted Data.Data"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Extracted Data.Data" = Table.ExpandTableColumn(#"Removed Columns", "Extracted Data.Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28", "Column29", "Column30", "Column31", "Column32", "Column33"}, {"Extracted Data.Data.Column1", "Extracted Data.Data.Column2", "Extracted Data.Data.Column3", "Extracted Data.Data.Column4", "Extracted Data.Data.Column5", "Extracted Data.Data.Column6", "Extracted Data.Data.Column7", "Extracted Data.Data.Column8", "Extracted Data.Data.Column9", "Extracted Data.Data.Column10", "Extracted Data.Data.Column11", "Extracted Data.Data.Column12", "Extracted Data.Data.Column13", "Extracted Data.Data.Column14", "Extracted Data.Data.Column15", "Extracted Data.Data.Column16", "Extracted Data.Data.Column17", "Extracted Data.Data.Column18", "Extracted Data.Data.Column19", "Extracted Data.Data.Column20", "Extracted Data.Data.Column21", "Extracted Data.Data.Column22", "Extracted Data.Data.Column23", "Extracted Data.Data.Column24", "Extracted Data.Data.Column25", "Extracted Data.Data.Column26", "Extracted Data.Data.Column27", "Extracted Data.Data.Column28", "Extracted Data.Data.Column29", "Extracted Data.Data.Column30", "Extracted Data.Data.Column31", "Extracted Data.Data.Column32", "Extracted Data.Data.Column33"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Expanded Extracted Data.Data", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([Company Code] <> "" and [Company Code] <> "Company Code")),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows1",{{"Budget #(lf)CO Order", Currency.Type}, {"Actual #(lf)CO Order", Currency.Type}, {"Commitment#(lf)Total", Currency.Type}, {"Commitment #(lf)P.Requisition", Currency.Type}, {"Commitment #(lf)P.Order", Currency.Type}, {"Actual #(lf)Alloted", Currency.Type}, {"Budget #(lf)Available", Currency.Type}, {"Demandbook#(lf)Cash Out Total #(lf)inc. VAT", Currency.Type}, {"Demandbook#(lf)Cash Out BudgetYear #(lf)inc. VAT", Currency.Type}, {"Demandbook #(lf)Cost effective BudgetYear #(lf)inc. VAT", Currency.Type}, {"Cash Out #(lf)Planning Year #(lf)(Net)", Currency.Type}, {"Cash Out #(lf)Plan Year #(lf)(Gross)", Currency.Type}, {"Net purchase order value (PR) - All", Currency.Type}, {"Net purchase order value (PR) - New without PO", Currency.Type}, {"Net purchase order value (PO)", Currency.Type}, {"Net purchase order value (PO+PR new)", Currency.Type}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"Fiscal year", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type1",{{"Budget #(lf)CO Order", "Budget Approved"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns",null,0,Replacer.ReplaceValue,{"Budget Approved", "Actual #(lf)CO Order", "Commitment#(lf)Total", "Commitment #(lf)P.Requisition", "Commitment #(lf)P.Order", "Actual #(lf)Alloted", "Budget #(lf)Available", "Demandbook#(lf)Cash Out Total #(lf)inc. VAT", "Demandbook#(lf)Cash Out BudgetYear #(lf)inc. VAT", "Demandbook #(lf)Cost effective BudgetYear #(lf)inc. VAT", "Cash Out #(lf)Planning Year #(lf)(Net)", "Cash Out #(lf)Plan Year #(lf)(Gross)", "Net purchase order value (PR) - All", "Net purchase order value (PR) - New without PO", "Net purchase order value (PO)", "Net purchase order value (PO+PR new)"}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Replaced Value",{{"SAP Refresh Time", type datetime}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type2", "KeyDemandPO", each [Demand ID]&"-"&[#"Purchasing order number (PO)"]),
		    #"Filtered Rows31" = Table.SelectRows(#"Added Custom", each ([Profit Center] <> "#" and [Profit Center] <> null )),
		    #"Filtered Rows3" = Table.SelectRows(#"Filtered Rows31", each Text.StartsWith([Demand ID], "GBUY") or Text.StartsWith([Demand ID], "RITM")),
		    #"Filtered Rows5" = Table.SelectRows(#"Filtered Rows3", each ([Vendor] <> "#")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows5", {"Demand ID"}),
		    #"Filtered Rows41" = Table.SelectRows(#"Removed Duplicates", each ([Profit Center] <> "#"))
		in
		    #"Filtered Rows41"
	lineageTag: 62a5daee-c53a-40e8-bbbf-57def651c5c2
	queryGroup: '08_Budget Report'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'O2I PreRun Costs' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows1" = Table.SelectRows(Source, each ([Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/06_O2C PreRun Analysis/Costs/")),
		    #"Removed Other Columns4" = Table.SelectColumns(#"Filtered Rows1",{"Content", "Name", "Date modified"}),
		    #"Added Custom1" = Table.AddColumn(#"Removed Other Columns4", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data2" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Expanded Extracted Data2",{"Data"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Other Columns2", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28", "Column29", "Column30", "Column31", "Column32", "Column33", "Column34", "Column35", "Column36", "Column37", "Column38", "Column39", "Column40", "Column41", "Column42", "Column43", "Column44", "Column45", "Column46", "Column47", "Column48"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23", "Data.Column24", "Data.Column25", "Data.Column26", "Data.Column27", "Data.Column28", "Data.Column29", "Data.Column30", "Data.Column31", "Data.Column32", "Data.Column33", "Data.Column34", "Data.Column35", "Data.Column36", "Data.Column37", "Data.Column38", "Data.Column39", "Data.Column40", "Data.Column41", "Data.Column42", "Data.Column43", "Data.Column44", "Data.Column45", "Data.Column46", "Data.Column47", "Data.Column48"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Expanded Data", [PromoteAllScalars=true]),
		    #"Removed Columns" = Table.RemoveColumns(#"Promoted Headers",{"Column37", "Column38", "Column39", "Column40", "Column41", "Column42", "Column43", "Column44", "Column45", "Column46", "Column47", "Column48"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Removed Columns",{"SI Provider", "SI SLA", "SI Location", "Secondary Name", "Product Order ID", "Product Name", "Primary Name", "Owner Account"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"Load Date", type date}, {"Service Date", type date}, {"Timestamp Load", type datetime}, {"Quantity", type number}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Material and Sales Organization", each [Sales Organization] &"-"&[Material]),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom", {"Payer"}, #"Group Debtors from SAP", {"Payer"}, "Group Debtors", JoinKind.LeftOuter),
		    #"Expanded Group Debtors" = Table.ExpandTableColumn(#"Merged Queries", "Group Debtors", {"Payer Name", "Country"}, {"Group Debtors.Payer Name", "Group Debtors.Country"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Expanded Group Debtors",{{"Group Debtors.Payer Name", "Payer Name"}, {"Group Debtors.Country", "Payer Country"}}),
		    #"Filtered Rows2" = Table.SelectRows(#"Renamed Columns1", each ([SAP Refresh Time] <> "SAP Refresh Time")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Filtered Rows2",{{"SAP Refresh Time", type datetime}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type1", "Type", each "Costs")
		in
		    #"Added Custom2"
	lineageTag: f2906106-853e-4a18-ad50-be2c006ac0c7
	queryGroup: '09_PreRun Analysis'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP Plan 2026-2028' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/04_Cost and Revenue/Plan/2026-2028/")),
		    #"Removed Other Columns4" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom1" = Table.AddColumn(#"Removed Other Columns4", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data2" = Table.ExpandTableColumn(#"Added Custom1", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Expanded Extracted Data2",{"Content", "Name", "Date modified"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28", "Column29", "Column30", "Column31", "Column32", "Column33", "Column34", "Column35", "Column36", "Column37", "Column38", "Column39", "Column40", "Column41", "Column42", "Column43", "Column44", "Column45", "Column46", "Column47", "Column48"}, {"Data.Column1", "Data.Column2", "Data.Column3", "Data.Column4", "Data.Column5", "Data.Column6", "Data.Column7", "Data.Column8", "Data.Column9", "Data.Column10", "Data.Column11", "Data.Column12", "Data.Column13", "Data.Column14", "Data.Column15", "Data.Column16", "Data.Column17", "Data.Column18", "Data.Column19", "Data.Column20", "Data.Column21", "Data.Column22", "Data.Column23", "Data.Column24", "Data.Column25", "Data.Column26", "Data.Column27", "Data.Column28", "Data.Column29", "Data.Column30", "Data.Column31", "Data.Column32", "Data.Column33", "Data.Column34", "Data.Column35", "Data.Column36", "Data.Column37", "Data.Column38", "Data.Column39", "Data.Column40", "Data.Column41", "Data.Column42", "Data.Column43", "Data.Column44", "Data.Column45", "Data.Column46", "Data.Column47", "Data.Column48"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Expanded Data", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([Company Code] <> "")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows1", each not Text.Contains([Company Code], "Company Code")),
		    #"Removed Other Columns" = Table.SelectColumns(#"Filtered Rows2",{"SAP Refresh Time", "Company Code", "Company Code Name", "Version", "Cost Element", "Cost Element Name", "Profit Center", "Profit Center Name", "Person responsible", "Cost Center", "Cost Center Name", "WBS Element", "WBS Element Name", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"}),
		    #"Unpivoted Columns" = Table.UnpivotOtherColumns(#"Removed Other Columns", {"SAP Refresh Time", "Company Code", "Company Code Name", "Version","Cost Element", "Cost Element Name", "Profit Center", "Profit Center Name", "Person responsible", "Cost Center", "Cost Center Name", "WBS Element", "WBS Element Name", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object"}, "Attribute", "Value"),
		    #"Merged Queries" = Table.NestedJoin(#"Unpivoted Columns", {"Version"}, #"Planning Versions", {"Version"}, "Planning Versions", JoinKind.LeftOuter),
		    #"Expanded Planning Versions" = Table.ExpandTableColumn(#"Merged Queries", "Planning Versions", {"Year"}, {"Year"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Expanded Planning Versions",{{"Year", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Date", each [Attribute] & "/" & [Year]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Month Date", type date}}),
		    #"Added Custom2" = Table.AddColumn(#"Changed Type", "CO Document Number", each ""),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Value", "Amount Plan"}, {"Profit Center Name", "Profit center Name"}, {"Profit Center", "Profit center"}, {"Cost Center", "Cost object"}, {"Cost Center Name", "Cost object Name"}}),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Renamed Columns",{"Company Code", "Company Code Name", "Version", "Cost Element", "Cost Element Name", "Profit center", "Profit center Name", "Cost object", "Cost object Name", "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name", "Customer Company Code", "Customer Object", "Amount Plan", "Month Date", "CO Document Number"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns2",{{"Debtor", "Payer"}, {"Debtor Name", "Payer Name"}})
		
		in
		    #"Renamed Columns1"
	lineageTag: 77c5ca1c-390b-439f-ad66-a97981239459
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_at45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"64bf773d-aa10-44ca-88c5-f01597de345a" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="64bf773d-aa10-44ca-88c5-f01597de345a"]}[Data],
		    extrernal_rate_cards_ = #"64bf773d-aa10-44ca-88c5-f01597de345a"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: eba75147-cc34-467c-b76b-48425c0eee56
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_at45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"64bf773d-aa10-44ca-88c5-f01597de345a" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="64bf773d-aa10-44ca-88c5-f01597de345a"]}[Data],
		    time_card_interface_set_a_ = #"64bf773d-aa10-44ca-88c5-f01597de345a"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    time_card_interface_set_a_
	lineageTag: ef108e8a-3052-4c6b-9dbf-c6f1f1a0047e
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_at45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"64bf773d-aa10-44ca-88c5-f01597de345a" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="64bf773d-aa10-44ca-88c5-f01597de345a"]}[Data],
		    time_card_interface_set_b_ = #"64bf773d-aa10-44ca-88c5-f01597de345a"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    time_card_interface_set_b_
	lineageTag: 84c70219-4534-49a4-8edf-7bd0e8fa93e0
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 AT45' =
		let
		    Source = Table.Combine({time_card_interface_set_a_at45, time_card_interface_set_b_at45}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: b125f9d7-c131-4cde-a333-a5e05160a5a3
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 SK44' =
		let
		
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    time_card_interface_externals_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="time_card_interface_externals",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> ""),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Time Card SYSID", "SAP State"})
		in
		    #"Removed Duplicates"
	lineageTag: be30b1fc-3e58-4862-9e6b-35348c4e6b50
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 HU44' =
		let
		
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    time_card_interface_externals_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="time_card_interface_externals",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: 884016ca-72a1-4319-a447-de4272aa72ec
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025' =
		let
		    Source = Table.Combine({#"PPM Time Card Interface Externals 2025 AT45", #"PPM Time Card Interface Externals 2025 SK44", #"PPM Time Card Interface Externals 2025 HU44", #"PPM Time Card Interface Externals 2025 SK45", #"PPM Time Card Interface Externals 2025 CZ45", #"PPM Time Card Interface Externals 2025 DE44"})
		in
		    Source
	lineageTag: 80964c70-7db4-4ad4-a431-4b93263e1739
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_sk44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    extrernal_rate_cards_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: ef803792-be67-41ac-93e6-8d623c52cb12
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_sk44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    extrernal_rate_cards_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: fd359150-fb0f-40ae-beac-cc51ceb8c1bf
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 SK44' =
		let
		    Source = Table.Combine({time_card_interface_set_b_sk44, time_card_interface_set_a_sk44}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: 2c8b5de2-781a-45d7-88f4-349782c3b8cd
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_hu44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    time_card_interface_set_a_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    time_card_interface_set_a_
	lineageTag: 5a4e535f-655c-45a6-ac19-7cd34eb0cbad
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_hu44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    time_card_interface_set_b_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    time_card_interface_set_b_
	lineageTag: 5f10d75f-4044-42f2-b610-f6f5c9635ee8
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 HU44' =
		let
		    Source = Table.Combine({time_card_interface_set_b_hu44, time_card_interface_set_a_hu44}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: 67b995bc-04b0-44ce-9fc0-b5e4f2915a31
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_sk44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"9328e8b0-fd79-4344-bccf-a85d4b875270" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="9328e8b0-fd79-4344-bccf-a85d4b875270"]}[Data],
		    extrernal_rate_cards_ = #"9328e8b0-fd79-4344-bccf-a85d4b875270"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: bb6c3efa-0333-46b1-948b-f22e95cf4188
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_hu44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"3dcc97ce-4082-437a-87d0-207ba3c31206" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="3dcc97ce-4082-437a-87d0-207ba3c31206"]}[Data],
		    extrernal_rate_cards_ = #"3dcc97ce-4082-437a-87d0-207ba3c31206"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: f656d7cf-9f38-4241-baf4-447ee20b82d5
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Projects DE44' = ```
		let
		
		
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    pm_projects_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="pm_projects",version=""]}[Data],
		    
		    #"Renamed Columns" = Table.RenameColumns(pm_projects_,{{"project_number", "Project Number"}, {"u_profit_center", "Sub Portfolio/ Profit Center"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Demand.1", each [u_ppm_request_envelope_id] & " - " & [demand]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom",{"u_ppm_request_envelope_id", "demand"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"Demand.1", "Demand"}, {"u_bill_code", "Bill Code"}, {"sys_id", "project_sys_id"}, {"primary_portfolio", "Project Portfolio"}, {"u_project_controller", "Project Controller"}, {"project_manager", "Project Manager / Product owner"}, {"u_project_manager_deputee", "Project Manager Deputy / Product Owner Deputy"}, {"u_project_category", "Project Category"}, {"u_project_state", "Project State"}, {"start_date", "Planned start date"}, {"end_date", "Planned end date"}, {"status", "Status"}, {"accounting_master", "Accounting Master"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "WBS", each "NA"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"u_ppm_debtor_relationship", "Debtor"}, {"u_complexity", "Complexity Level"}, {"u_project_sponsor", "Project Sponsor"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns2", "Planned start date 1", each DateTime.FromText([Planned start date], "en-US")),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Planned end date 1", each DateTime.FromText([Planned end date], "en-US")),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom4",{{"Planned end date 1", type date}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Changed Type1",{{"Planned start date 1", type date}}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Changed Type",{{"u_az_group_project_id", "Group Project ID"}, {"percent_complete", "Percent Complete"}, {"short_description", "Project Name"}, {"u_company_code", "Company Code"}, {"ExportFor", "Exported For"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns5",{"Planned start date", "Planned end date"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns1",{{"Planned start date 1", "Planned start date"}, {"Planned end date 1", "Planned end date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns3", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom2", "AM Key", each [Project Number]&[Exported For]),
		    #"Removed Other Columns" = Table.SelectColumns(#"Added Custom5",{"Project Name", "Project Number", "Accounting Master", "project_sys_id", "Project State", "Project Category", "Bill Code", "Debtor", "Sub Portfolio/ Profit Center", "Project Portfolio", "Percent Complete", "Project Manager / Product owner", "Project Manager Deputy / Product Owner Deputy", "Status", "Complexity Level", "Project Controller", "Project Sponsor", "Group Project ID", "Company Code", "Exported For", "Demand", "WBS", "Planned start date", "Planned end date"}),
		    #"Added Custom12" = Table.AddColumn(#"Removed Other Columns", "Year Service", each if Date.Year([Planned end date]) >= Date.Year(DateTime.LocalNow()) then Text.From(Date.Year(DateTime.LocalNow())) else Text.From(Date.Year([Planned end date]))),
		    #"Changed Type22" = Table.TransformColumnTypes(#"Added Custom12",{{"Planned start date", type date}, {"Planned end date", type date}})
		in
		    #"Changed Type22"
		```
	lineageTag: 4a83c430-890f-4fbe-be9f-84e0e7d3cde9
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Accounting Elements DE44' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    u_ppm_accounting_element_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="u_ppm_accounting_element",version=""]}[Data],
		
		
		    #"Renamed Columns" = Table.RenameColumns(u_ppm_accounting_element_,{{"u_wbs_element_id", "WBS Element ID"}, {"u_name", "Accounting Element"}, {"accounting_master", "Accounting Master"}, {"u_element_approved", "SAP Approved"}, {"u_expense_type", "Expense Type"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"WBS Element ID", type text}, {"Accounting Element", type text}, {"Accounting Master", type text}, {"SAP Approved", type text}, {"Expense Type", type text}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Project Number", each Text.End([Accounting Master],10)),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Expense Type] = "Capex")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"Expense Type", "Project Number"})
		in
		    #"Removed Duplicates"
	lineageTag: 2c755395-c200-42f0-b255-9b062124efe7
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards DE44 2025' = ```
		let
		 
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"0f687a4e-0d03-4ff5-82c6-36da411fe423" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="0f687a4e-0d03-4ff5-82c6-36da411fe423"]}[Data],
		    time_cards_ = #"0f687a4e-0d03-4ff5-82c6-36da411fe423"{[entity="time_cards",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_cards_,{{"RefreshDate", "Export Date"}, {"ExportFor", "Export For"}, {"u_project_manager", "Project Manager"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Created", each DateTime.LocalNow()),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom",{{"u_prj_unit_resp", "Project Unit Responsible(Cost Center)"}, {"u_dept_cost_center", "Department Cost Center"}, {"user", "User"}, {"u_project_name", "Project Name"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns1", "Export Date 1", each DateTime.FromText([Export Date], "en-US")),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom1",{"Export Date"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"project_number", "Project"}, {"Export Date 1", "Export Date"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Task", each "NA"),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Accounting Element", each "NA"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom3",{{"resource_plan", "Resource plan"}}),
		    #"Added Custom4" = Table.AddColumn(#"Renamed Columns3", "Activity Cluster", each "NA"),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Correction", each "False"),
		    #"Renamed Columns4" = Table.RenameColumns(#"Added Custom5",{{"state", "State"}, {"monday", "Monday"}, {"tuesday", "Tuesday"}, {"wednesday", "Wednesday"}, {"thursday", "Thursday"}, {"friday", "Friday"}, {"saturday", "Saturday"}, {"sunday", "Sunday"}, {"sys_updated_by", "Updated by"}, {"total", "Total"}, {"sys_updated_on", "Updated"}, {"category", "Category"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns4", "Comments", each "NA"),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom6",{{"u_rate_role", "CO Rate Role"}, {"tc_sys_id", "SYSID"}}),
		    #"Added Custom7" = Table.AddColumn(#"Renamed Columns5", "Actual Hours", each [Total]),
		    #"Added Custom8" = Table.AddColumn(#"Added Custom7", "PPM Pilars", each "NA"),
		    #"Added Custom9" = Table.AddColumn(#"Added Custom8", "RG Pillars", each "NA"),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom9", "Department", each "NA"),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "RG Pillars.1", each "NA"),
		    #"Renamed Columns6" = Table.RenameColumns(#"Added Custom11",{{"Project Manager", "PM"}}),
		    #"Added Custom12" = Table.AddColumn(#"Renamed Columns6", "PM Dep", each "NA"),
		    #"Renamed Columns7" = Table.RenameColumns(#"Added Custom12",{{"u_resource_manager", "RM"}}),
		    #"Added Custom13" = Table.AddColumn(#"Renamed Columns7", "Accounting Element4", each "NA"),
		    #"Added Custom14" = Table.AddColumn(#"Added Custom13", "Project Task Name", each "NA"),
		    #"Added Custom15" = Table.AddColumn(#"Added Custom14", "Res Plan Name", each "NA"),
		    #"Added Custom16" = Table.AddColumn(#"Added Custom15", "Resource Group", each "NA"),
		    #"Renamed Columns8" = Table.RenameColumns(#"Added Custom16",{{"rate", "CO Rate Role2"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns8", "AT PD", each "NA"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom17",{{"user_name", "User ID"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns9","_PAD01","",Replacer.ReplaceText,{"User ID"}),
		    #"Added Custom18" = Table.AddColumn(#"Replaced Value", "User ID 2", each [User ID]),
		    #"Added Custom19" = Table.AddColumn(#"Added Custom18", "Line Manager", each "NA"),
		    #"Added Custom20" = Table.AddColumn(#"Added Custom19", "AZ AT User ID", each "NA"),
		    #"Added Custom21" = Table.AddColumn(#"Added Custom20", "Debtor", each "NA"),
		    #"Added Custom22" = Table.AddColumn(#"Added Custom21", "Billcode", each ""),
		    #"Added Custom23" = Table.AddColumn(#"Added Custom22", "Company Code", each "NA"),
		    #"Added Custom24" = Table.AddColumn(#"Added Custom23", "Member Company", each ""),
		    #"Added Custom25" = Table.AddColumn(#"Added Custom24", "Project Category", each ""),
		    #"Added Custom26" = Table.AddColumn(#"Added Custom25", "POL", each "NA"),
		    #"Added Custom27" = Table.AddColumn(#"Added Custom26", "POL + USERSID", each "NA"),
		    #"Added Custom28" = Table.AddColumn(#"Added Custom27", "Vendor Name", each ""),
		    #"Added Custom29" = Table.AddColumn(#"Added Custom28", "Ext Rate Value", each "NA"),
		    #"Added Custom30" = Table.AddColumn(#"Added Custom29", "Purchase Order", each "NA"),
		    #"Added Custom31" = Table.AddColumn(#"Added Custom30", "Purchase No", each "NA"),
		    #"Added Custom32" = Table.AddColumn(#"Added Custom31", "PO Status", each "NA"),
		    #"Added Custom33" = Table.AddColumn(#"Added Custom32", "GBUY", each "NA"),
		    #"Added Custom34" = Table.AddColumn(#"Added Custom33", "WBS Element", each "NA"),
		    #"Added Custom35" = Table.AddColumn(#"Added Custom34", "Planing WBS Element", each "NA"),
		    #"Added Custom36" = Table.AddColumn(#"Added Custom35", "Shoring", each "NA"),
		    #"Added Custom37" = Table.AddColumn(#"Added Custom36", "PO Costs", each "NA"),
		    #"Added Custom38" = Table.AddColumn(#"Added Custom37", "Current Costs", each "NA"),
		    #"Merged Queries" = Table.NestedJoin(#"Added Custom38", {"project_sys_id", "Export For"}, #"PPM Projects DE44", {"project_sys_id", "Exported For"}, "PPM Projects 1", JoinKind.LeftOuter),
		    #"Merged Queries1" = Table.NestedJoin(#"Merged Queries", {"user_sys_id"}, extrernal_rate_cards_de44_unique, {"user_sys_id"}, "extrernal_rate_cards", JoinKind.LeftOuter),
		    #"Expanded PPM Projects 1" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Projects 1", {"Bill Code", "Company Code", "Debtor", "Project Category", "Project Manager Deputy / Product Owner Deputy"}, {"PPM Projects 1.Bill Code", "PPM Projects 1.Company Code", "PPM Projects 1.Debtor", "PPM Projects 1.Project Category", "PPM Projects 1.Project Manager Deputy / Product Owner Deputy"}),
		    #"Expanded extrernal_rate_cards" = Table.ExpandTableColumn(#"Expanded PPM Projects 1", "extrernal_rate_cards", {"u_vendor_name", "rate_per_hour_eur"}, {"extrernal_rate_cards.u_vendor_name", "extrernal_rate_cards.rate_per_hour_eur"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded extrernal_rate_cards",{"Ext Rate Value"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"extrernal_rate_cards.rate_per_hour_eur", "Ext Rate Value"}}),
		    #"Removed Columns2" = Table.RemoveColumns(#"Renamed Columns10",{"Vendor Name"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Removed Columns2",{{"extrernal_rate_cards.u_vendor_name", "Vendor Name"}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Renamed Columns11",{"Debtor", "Billcode"}),
		    #"Renamed Columns12" = Table.RenameColumns(#"Removed Columns3",{{"PPM Projects 1.Bill Code", "Billcode"}, {"PPM Projects 1.Debtor", "Debtor"}}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Renamed Columns12",{"Company Code"}),
		    #"Renamed Columns13" = Table.RenameColumns(#"Removed Columns4",{{"PPM Projects 1.Company Code", "Company Code"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns13",{"RG Pillars.1", "Project Category"}),
		    #"Renamed Columns14" = Table.RenameColumns(#"Removed Columns5",{{"PPM Projects 1.Project Category", "Project Category"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns14",{"PM Dep"}),
		    #"Renamed Columns16" = Table.RenameColumns(#"Removed Columns6",{{"PPM Projects 1.Project Manager Deputy / Product Owner Deputy", "PM Dep"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns16", each [SYSID] <> ""),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"week_starts_on", type date}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"week_starts_on", type any}}),
		    #"Renamed Columns15" = Table.RenameColumns(#"Changed Type1",{{"week_starts_on", "Week starts on"}, {"Billcode", "BillCode"}})
		in
		    #"Renamed Columns15"
		```
	lineageTag: 088a7b72-3979-434e-af1e-a45d0532f1db
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_sk45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    extrernal_rate_cards_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: a1e41fa8-dbb9-4346-999c-08f592879cf2
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_sk45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    time_card_interface_set_a_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    time_card_interface_set_a_
	lineageTag: bbbd4ba9-e7a4-4e2d-977a-9c2113bcca6e
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_sk45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    time_card_interface_set_b_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    time_card_interface_set_b_
	lineageTag: 742deccd-6471-41c4-808c-5e26a1ddedab
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 SK45' =
		let
		    Source = Table.Combine({time_card_interface_set_b_sk45, time_card_interface_set_a_sk45}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: 62340eb6-3bf5-4483-a30d-b45bf5c134c2
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 SK45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"86b316a2-33a3-473a-8ead-04130f69075e" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="86b316a2-33a3-473a-8ead-04130f69075e"]}[Data],
		    time_card_interface_externals_ = #"86b316a2-33a3-473a-8ead-04130f69075e"{[entity="time_card_interface_externals",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each ([Time Card SYSID] <> ""))
		in
		    #"Filtered Rows"
	lineageTag: 9af44af2-b73d-40f0-8fcc-c7d6b3a45967
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_cz45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    extrernal_rate_cards_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: f1b32963-3ee9-4bc2-8816-80f1ccc4b41c
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_cz45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    time_card_interface_set_b_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    time_card_interface_set_b_
	lineageTag: 3a2d7079-2fd4-41f1-b614-eec9bb4b09ae
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_cz45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    time_card_interface_set_a_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    time_card_interface_set_a_
	lineageTag: 17e9d977-1cc2-41eb-ab7c-87d32a37a6c0
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 CZ45' =
		let
		    Source = Table.Combine({time_card_interface_set_b_cz45, time_card_interface_set_a_cz45}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: c28a66ee-6b9e-41db-988d-21f991f8f0dc
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 CZ45' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"a3f641e9-996e-43b8-814a-1c5848193461" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="a3f641e9-996e-43b8-814a-1c5848193461"]}[Data],
		    time_card_interface_externals_ = #"a3f641e9-996e-43b8-814a-1c5848193461"{[entity="time_card_interface_externals",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each ([Time Card SYSID] <> ""))
		in
		    #"Filtered Rows"
	lineageTag: 74de60f5-c05a-42b9-b6ed-a4269cf3fe8f
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_de44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    extrernal_rate_cards_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="extrernal_rate_cards",version=""]}[Data]
		in
		    extrernal_rate_cards_
	lineageTag: a35e61ea-c1c1-4390-b2b0-151e525b148a
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_a_de44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    time_card_interface_set_a_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="time_card_interface_set_a",version=""]}[Data]
		in
		    time_card_interface_set_a_
	lineageTag: f1c49da8-6e6d-4211-be8b-20b6e7722be1
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression time_card_interface_set_b_de44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    time_card_interface_set_b_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="time_card_interface_set_b",version=""]}[Data]
		in
		    time_card_interface_set_b_
	lineageTag: 5a563714-6cbb-4a8f-9eb9-e2e3771aad96
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface 2025 DE44' =
		let
		    Source = Table.Combine({time_card_interface_set_b_de44, time_card_interface_set_a_de44}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"week_starts_on", "comments", "ExportFor"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "SAP Posting Date", each DateTime.FromText([posting_date],"en-US")),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom",{"posting_date"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns1",{{"SAP Posting Date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each [Time Card SYSID] <> "")
		in
		    #"Filtered Rows"
	lineageTag: 33013a8b-ee63-4da2-a4ee-d3f298f5cf13
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Card Interface Externals 2025 DE44' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"983395ae-a856-40c0-bc0d-1e20039af4af" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="983395ae-a856-40c0-bc0d-1e20039af4af"]}[Data],
		    time_card_interface_externals_ = #"983395ae-a856-40c0-bc0d-1e20039af4af"{[entity="time_card_interface_externals",version=""]}[Data],
		
		    #"Renamed Columns" = Table.RenameColumns(time_card_interface_externals_,{{"tc_sys_id", "Time Card SYSID"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"posting_date", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"posting_date", "SAP Posting Date"}, {"comments", "Comment"}, {"state", "SAP State"}}),
		    #"Filtered Rows" = Table.SelectRows(#"Renamed Columns1", each ([Time Card SYSID] <> ""))
		in
		    #"Filtered Rows"
	lineageTag: 165ad6c9-6d02-4622-aa7b-fb41a0fa6909
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources HU44 NEW' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/2025/HU44/"),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees DE1214_AZTEC_HUN.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Removed Columns4" = Table.RemoveColumns(#"Added Custom1",{"Rate Card", "Invoicing Method"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns4",{{"EC ID", type text}}),
		    #"Trimmed Text" = Table.TransformColumns(#"Changed Type",{{"EC ID", Text.Trim, type text}}),
		    #"Cleaned Text" = Table.TransformColumns(#"Trimmed Text",{{"EC ID", Text.Clean, type text}}),
		    #"Merged Queries" = Table.NestedJoin(#"Cleaned Text", {"EC ID"}, #"Rate Cards HU44", {"User ID"}, "Rate Cards HU44", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SK45" = Table.ExpandTableColumn(#"Merged Queries", "Rate Cards HU44", {"Rate Card Full", "Invoicing Method"}, {"Rate Card Full", "Invoicing Method"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Expanded Rate Cards SK45",null,"Overhead-Aut",Replacer.ReplaceValue,{"Rate Card Full"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",null,"Overhead",Replacer.ReplaceValue,{"Invoicing Method"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value2",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"Work Location - City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{ "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card Full", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Changed Type2",{"Sales Organisation"}),
		    #"Added Custom6" = Table.AddColumn(#"Removed Columns3", "Sales Organisation", each "HU44"),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom6",{{"DisciplinaryOrgUnit ID", "Disciplinary OrgUnit ID"}, {"FunctionalOrgUnit ID", "Functional OrgUnit ID"}}),
		    #"Extracted Text Before Delimiter" = Table.TransformColumns(#"Renamed Columns1", {{"Functional OrgUnit ID", each Text.BeforeDelimiter(_, ";"), type text}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Extracted Text Before Delimiter",{{"EC ID", "Local ID"}})
		in
		    #"Renamed Columns4"
	lineageTag: e2cd44f7-757b-48f2-816d-77e63bc3bf62
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources SK45 NEW' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/2025/SK45/"),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees SK0039.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Removed Columns4" = Table.RemoveColumns(#"Added Custom1",{"Rate Card", "Invoicing Method"}),
		    #"Merged Queries" = Table.NestedJoin(#"Removed Columns4", {"Personal Number"}, #"Rate Cards SK45", {"User ID"}, "Rate Cards SK45", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SK45" = Table.ExpandTableColumn(#"Merged Queries", "Rate Cards SK45", {"Rate Card Full", "Invoicing Method"}, {"Rate Card Full", "Invoicing Method"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Expanded Rate Cards SK45",null,"Overhead-Aut",Replacer.ReplaceValue,{"Rate Card Full"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",null,"Overhead",Replacer.ReplaceValue,{"Invoicing Method"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value2",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"Work Location - City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card Full", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Changed Type2",{"Sales Organisation"}),
		    #"Added Custom6" = Table.AddColumn(#"Removed Columns3", "Sales Organisation", each "SK45"),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom6",{{"DisciplinaryOrgUnit ID", "Disciplinary OrgUnit ID"}, {"FunctionalOrgUnit ID", "Functional OrgUnit ID"}}),
		    #"Extracted Text Before Delimiter" = Table.TransformColumns(#"Renamed Columns1", {{"Functional OrgUnit ID", each Text.BeforeDelimiter(_, ";"), type text}})
		in
		    #"Extracted Text Before Delimiter"
	lineageTag: c78a85b6-450c-4d29-9bf6-01323e21fec4
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'SAP Internal Resources SK44 NEW' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/2025/SK44/"),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees DE1214_AZTEC_SVK.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Removed Columns4" = Table.RemoveColumns(#"Added Custom1",{"Rate Card", "Invoicing Method"}),
		    #"Merged Queries" = Table.NestedJoin(#"Removed Columns4", {"Personal Number"}, #"Rate Cards SK44", {"User ID"}, "Rate Cards SK44", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SK45" = Table.ExpandTableColumn(#"Merged Queries", "Rate Cards SK44", {"Rate Card Full", "Invoicing Method"}, {"Rate Card Full", "Invoicing Method"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Expanded Rate Cards SK45",null,"Overhead-Aut",Replacer.ReplaceValue,{"Rate Card Full"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",null,"Overhead",Replacer.ReplaceValue,{"Invoicing Method"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value2",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"Work Location - City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card Full", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Changed Type2",{"Sales Organisation"}),
		    #"Added Custom6" = Table.AddColumn(#"Removed Columns3", "Sales Organisation", each "SK44"),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom6",{{"FunctionalOrgUnit ID", "Functional OrgUnit ID"}, {"DisciplinaryOrgUnit ID", "Disciplinary OrgUnit ID"}}),
		    #"Extracted Text Before Delimiter" = Table.TransformColumns(#"Renamed Columns1", {{"Functional OrgUnit ID", each Text.BeforeDelimiter(_, ";"), type text}})
		in
		    #"Extracted Text Before Delimiter"
	lineageTag: 4dac31f2-bfad-4acb-add1-75e3b4e5f1bd
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'SAP Internal Resources CZ45 NEW' =
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each [Folder Path] = "https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared Documents/01_Power BI/Data Sources/03_HR/Employee List/2025/CZ45/"),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Filtered Rows",{"Content", "Name", "Date modified"}),
		    #"Added Custom2" = Table.AddColumn(#"Removed Other Columns1", "Extracted Data", each Table.SelectRows(Excel.Workbook([Content]), each [Item] = "Sheet1")),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Added Custom2", "Extracted Data", {"Data"}, {"Data"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Expanded Extracted Data",{"Content"}),
		    #"Expanded Data" = Table.ExpandTableColumn(#"Removed Columns1", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}),
		    #"Added Custom4" = Table.AddColumn(#"Expanded Data", "File Name", each if [Column1] = "User ID" then "File Name" else [Name]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom4", "Refresh Date", each if [Column1] = "User ID" then "Refresh Date" else [Date modified]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom3",{"Name", "Date modified"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns2", [PromoteAllScalars=true]),
		    #"Filtered Rows1" = Table.SelectRows(#"Promoted Headers", each ([HR Number] <> "HR Number")),
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1"," Employees CZ0034.xlsx","",Replacer.ReplaceText,{"File Name"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value",{{"File Name", type date}}),
		    #"Added Custom" = Table.AddColumn(#"Changed Type1", "Month Service", each Date.ToText([File Name],"MMM","en-US") & " " &Date.ToText([File Name],"yyyy","en-US")),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom",{{"HR Number", "Personal Number"}, {"Active Head Count", "AHC"}, {"Full time Employee", "FTE"}}),
		    #"Added Custom1" = Table.AddColumn(#"Renamed Columns", "Employee Name", each [First Name] & " " & [Last Name]),
		    #"Removed Columns4" = Table.RemoveColumns(#"Added Custom1",{"Rate Card", "Invoicing Method"}),
		    #"Merged Queries" = Table.NestedJoin(#"Removed Columns4", {"Personal Number"}, #"Rate Cards CZ45", {"User ID"}, "Rate Cards CZ45", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SK45" = Table.ExpandTableColumn(#"Merged Queries", "Rate Cards CZ45", {"Rate Card Full", "Invoicing Method"}, {"Rate Card Full", "Invoicing Method"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Expanded Rate Cards SK45",null,"Overhead-Aut",Replacer.ReplaceValue,{"Rate Card Full"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",null,"Overhead",Replacer.ReplaceValue,{"Invoicing Method"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value2",{{"Company Code", "Sales Organisation"}, {"Company Name", "Company"}, {"Work Location - City", "Location Name"}, {"HR Manager Name", "My HR Manager"}, {"Start Date of employment", "Start Date"}, {"End Date of Employment", "End Date"}, {"Invoicing Method", "Invoicing Method Direct"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"EC ID", "Last Name", "First Name", "Head Count", "File Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Team Name", "Role Type"}, {"Rate Card Full", "Rate Card Direct"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Cost Center", type text}, {"Month Service", type date}, {"Start Date", type date}, {"End Date", type date}, {"Date of Birth", type date}, {"Refresh Date", type datetime}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Changed Type2",{"Sales Organisation"}),
		    #"Added Custom6" = Table.AddColumn(#"Removed Columns3", "Sales Organisation", each "CZ45"),
		    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom6",{{"DisciplinaryOrgUnit ID", "Disciplinary OrgUnit ID"}, {"FunctionalOrgUnit ID", "Functional OrgUnit ID"}}),
		    #"Extracted Text Before Delimiter" = Table.TransformColumns(#"Renamed Columns1", {{"Functional OrgUnit ID", each Text.BeforeDelimiter(_, ";"), type text}})
		in
		    #"Extracted Text Before Delimiter"
	lineageTag: e5f11fa1-37c8-4b68-9af1-1b43af39b5ea
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_sk44_unique =
		let
		    Source = extrernal_rate_cards_sk44,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: 9d7f4cb8-510b-4b03-b458-7486fdf9c8f0
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_hu44_unique =
		let
		    Source = extrernal_rate_cards_hu44,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: fcdf2470-0aeb-47e9-a80c-9d61567ff3d4
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_sk45_unique =
		let
		    Source = extrernal_rate_cards_sk45,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: e8551fd6-fefd-4ab4-9c9d-ec27afa34486
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression extrernal_rate_cards_cz45_unique =
		let
		    Source = extrernal_rate_cards_cz45,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: 05ca206c-5a89-4788-9b0e-815a7f41ee18
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_de44_unique =
		let
		    Source = extrernal_rate_cards_de44,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: 5e515918-f487-4cf2-bf90-d3d65f7989e3
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression extrernal_rate_cards_at45_unique =
		let
		    Source = extrernal_rate_cards_at45,
		    #"Sorted Rows" = Table.Sort(Source,{{"po_number", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"user_sys_id"})
		in
		    #"Removed Duplicates"
	lineageTag: 2db042ff-15c0-48e3-8bdc-85781c853742
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Rate Cards HU44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Employee%20List/2025/Rate%20Cards/2025%20Rate%20Cards%20HU44_V1.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(GradeandProficiencyLevels_Table, [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"Personal #(lf)number", "User ID"}, {"Full name", "Employee Name"}, {"Rate Card", "Rate Card Full"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Invoicing Method", each if [Rate Card Full] = "Overhead" then "Overhead" else "T&M"),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"User ID", type text}})
		in
		    #"Changed Type"
	lineageTag: 7f1f1810-1724-48f4-b4dc-5e3267b75262
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Rate Cards SK45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Employee%20List/2025/Rate%20Cards/2025%20Rate%20Cards%20SK45_V1.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(GradeandProficiencyLevels_Table, [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"Personal #(lf)number", "User ID"}, {"Full name", "Employee Name"}, {"Rate Card", "Rate Card Full"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Invoicing Method", each if [Rate Card Full] = "Overhead" then "Overhead" else "T&M")
		in
		    #"Added Custom"
	lineageTag: 95671cb3-881d-42be-8c30-7cf9e6674992
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Rate Cards SK44' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Employee%20List/2025/Rate%20Cards/2025%20Rate%20Cards%20SK44_V1.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(GradeandProficiencyLevels_Table, [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"Personal #(lf)number", "User ID"}, {"Full name", "Employee Name"}, {"Rate Card", "Rate Card Full"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Invoicing Method", each if [Rate Card Full] = "Overhead" then "Overhead" else "T&M")
		in
		    #"Added Custom"
	lineageTag: fa3fa5be-b683-4f9d-9d87-99dbfcd3b8e0
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Rate Cards CZ45' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/03_HR/Employee%20List/2025/Rate%20Cards/2025%20Rate%20Cards%20CZ45_V1.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(GradeandProficiencyLevels_Table, [PromoteAllScalars=true]),
		    #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"Personal #(lf)number", "User ID"}, {"Full name", "Employee Name"}, {"Rate Card", "Rate Card Full"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Invoicing Method", each if [Rate Card Full] = "Overhead" then "Overhead" else "T&M")
		in
		    #"Added Custom"
	lineageTag: 850f2411-c5a5-4b57-8541-1e4c3abdaaaa
	queryGroup: '03_HR SAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards All' =
		let
		    Source = Table.Combine({#"PPM Time Cards AT", #"PPM Time Cards SK44 NEW", #"PPM Time Cards SK45 NEW", #"PPM Time Cards CZ45 NEW", #"PPM Time Cards HU44 NEW"}),
		    #"Added Custom" = Table.AddColumn(Source, "Date 1", each [Week starts on]),
		    #"Added Custom1" = Table.AddColumn(#"Added Custom", "Date 2", each Date.AddDays([Week starts on],1)),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom1", "Date 3", each Date.AddDays([Week starts on],2)),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Date 4", each Date.AddDays([Week starts on],3)),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Date 5", each Date.AddDays([Week starts on],4)),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Date 6", each Date.AddDays([Week starts on],5)),
		    #"Added Custom6" = Table.AddColumn(#"Added Custom5", "Date 7", each Date.AddDays([Week starts on],6)),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Added Custom6", {"Date 1", "Date 2", "Date 3", "Date 4", "Date 5", "Date 6", "Date 7"}, "Attribute", "Value"),
		    #"Unpivoted Only Selected Columns1" = Table.Unpivot(#"Unpivoted Only Selected Columns", {"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"}, "Attribute.1", "Value.1"),
		    #"Added Custom7" = Table.AddColumn(#"Unpivoted Only Selected Columns1", "Day", each Date.DayOfWeekName([Value],"en-US")),
		    Custom1 = Table.TransformColumnTypes(#"Added Custom7",{{"Value", type date}, {"Day", type text}}),
		    #"Renamed Columns" = Table.RenameColumns(Custom1,{{"Value.1", "TimeN"}, {"Attribute.1", "Day Name"}, {"Day", "Day Name 2"}}),
		    #"Changed Type9" = Table.TransformColumnTypes(#"Renamed Columns",{{"TimeN", type text}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Changed Type9",".",",",Replacer.ReplaceText,{"TimeN"}),
		    #"Changed Type7" = Table.TransformColumnTypes(#"Replaced Value",{{"TimeN", Currency.Type}}),
		    #"Added Custom8" = Table.AddColumn(#"Changed Type7", "CorrectedTime", each if ([Day Name] = [Day Name 2] and [TimeN]<>0)  then [TimeN]/8 else 0),
		    #"Changed Type8" = Table.TransformColumnTypes(#"Added Custom8",{{"CorrectedTime", Currency.Type}}),
		    #"Added Custom9" = Table.AddColumn(#"Changed Type8", "CorrectedMonth", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3)),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom9", "Month Service", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3) & " "& Text.From(Date.Year([Value]))),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom11",{{"CorrectedMonth", type text}}),
		    #"Added Custom12" = Table.AddColumn(#"Changed Type2", "Booking Month", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3)),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom12", "Check", each if [Booking Month] = [CorrectedMonth] then 0 else 1),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom10", each ([CorrectedTime] <> 0)),
		    #"Added Custom13" = Table.AddColumn(#"Filtered Rows", "Total PDs", each [CorrectedTime]),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom13",{{"Value", "Date of Time Booking"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns5",{{"Total PDs", Currency.Type}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type",{"Export Date", "Export For", "Week starts on", "Created", "Project Manager", "Project Unit Responsible(Cost Center)", "Department Cost Center", "User", "Project", "Project Name", "Task", "Accounting Element", "Resource plan", "Activity Cluster", "Correction", "State", "Approved by", "Total", "Updated", "Updated by", "Category", "Comments", "CO Rate Role", "SYSID", "Actual Hours", "PPM Pilars", "Department", "RG Pillars", "PM", "PM Dep", "RM", "Accounting Element4", "Project Task Name", "Res Plan Name", "Resource Group", "CO Rate Role2", "AT PD", "User ID", "User ID 2", "Line Manager", "AZ AT User ID", "Debtor", "BillCode", "Company Code", "Project Category", "Vendor Name", "Ext Rate Value", "Date of Time Booking", "TimeN", "Month Service", "Total PDs"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Removed Other Columns","","N/A",Replacer.ReplaceValue,{"Vendor Name"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Replaced Value3",{{"Project Unit Responsible(Cost Center)", "Project Cost Center"}, {"User", "Booked By"}, {"Correction", "Booking Correction"}, {"State", "Booking State"}, {"Updated", "Updated on"}, {"Category", "Booking Category"}, {"Actual Hours", "Actual Hours From Resoure Plan"}, {"Res Plan Name", "Resource Plan Name"}, {"CO Rate Role", "User Rate Card"}, {"User ID", "User ID Long"}, {"User ID 2", "User ID"}, {"Created", "Created on"}, {"Project", "Project Number"}, {"PM Dep", "Project Manager Deputy"}, {"RM", "Resource Manager"}, {"Accounting Element", "Accounting Element and Project Name"}, {"Accounting Element4", "WBS Element"}, {"Total", "Total Booked Hours"},{"BillCode", "Bill Code"}}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1",{"Export Date", "Export For", "Week starts on", "Created on", "Project Manager", "Project Cost Center", "Department Cost Center", "Booked By", "Project Number", "Project Name", "Task", "Resource plan", "Activity Cluster", "Booking Correction", "Booking State", "Approved by", "Updated on", "Updated by", "Booking Category", "Comments", "User Rate Card", "SYSID", "Actual Hours From Resoure Plan", "PM", "Project Manager Deputy", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "CO Rate Role2", "AT PD", "User ID", "Line Manager", "Debtor", "Bill Code", "Company Code", "Project Category", "Vendor Name", "Ext Rate Value", "Date of Time Booking", "TimeN", "Month Service", "Total PDs"}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Removed Other Columns1",{{"TimeN", "Total Booked Hours"}}),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Renamed Columns7",{{"Total Booked Hours", Currency.Type}}),
		    #"Grouped Rows" = Table.Group(#"Changed Type6", {"Export Date", "Export For", "Project Manager", "Project Cost Center", "Department Cost Center", "Booked By", "Project Number", "Project Name", "Task", "Resource plan", "Activity Cluster", "Booking Correction", "Booking State", "Approved by", "Booking Category", "Comments", "Actual Hours From Resoure Plan", "Project Manager Deputy", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "CO Rate Role2", "User ID", "Line Manager", "Debtor", "Bill Code", "Company Code", "Month Service", "Project Category", "Ext Rate Value", "Vendor Name", "SYSID", "Date of Time Booking", "Updated on", "Updated by", "Week starts on"}, {{"Total PDs", each List.Sum([Total PDs]), type nullable number}, {"Total Hours", each List.Sum([Total Booked Hours]), type nullable number}}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Grouped Rows",{{"CO Rate Role2", "User Rate Card"}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Renamed Columns3",{ "Export Date", "Month Service", "Booked By", "User ID", "Booking State", "Total PDs", "Total Hours", "Project Number", "Project Name", "Project Category", "Project Manager", "Project Manager Deputy", "Project Cost Center", "Department Cost Center", "Task", "Resource plan", "Activity Cluster", "Booking Correction", "Approved by", "Booking Category", "Comments", "Actual Hours From Resoure Plan", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "User Rate Card", "Line Manager", "Debtor", "Bill Code", "Company Code"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Reordered Columns",{{"Export Date", type datetime}}),
		    #"Added Custom16" = Table.AddColumn(#"Changed Type1", "Project / Activity Name", each if [Booking Category] <> "Project/Project Task" then [Booking Category] else [Project Number] & "-" & [Project Name]),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom16",{{"Month Service", type date}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Changed Type3",{{"Month Service", "Month Date"}}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Renamed Columns2",{{"Ext Rate Value", type text}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Changed Type4",".",",",Replacer.ReplaceText,{"Ext Rate Value"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",", ",",",Replacer.ReplaceText,{"Ext Rate Value"}),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Replaced Value2",{{"Ext Rate Value", Currency.Type}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type5",{{"Ext Rate Value", "External Rate"}}),
		    #"Multiplied Column" = Table.TransformColumns(#"Renamed Columns4", {{"External Rate", each _ * 8, Currency.Type}}),
		    #"Merged Queries1" = Table.NestedJoin(#"Multiplied Column", {"User ID"}, #"PPM Deactiveated Users", {"User ID"}, "PPM Deactiveated Users", JoinKind.LeftOuter),
		    #"Expanded PPM Deactiveated Users" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Deactiveated Users", {"User ID Final"}, {"PPM Deactiveated Users.User ID Final"}),
		    #"Renamed Columns9" = Table.RenameColumns(#"Expanded PPM Deactiveated Users",{{"PPM Deactiveated Users.User ID Final", "User ID for Deactivated"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns9", "User ID Corrected", each if [User ID for Deactivated] <> null then [User ID for Deactivated] else [User ID]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom17",{"User ID", "User ID for Deactivated"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"User ID Corrected", "User ID"}}),
		    #"Merged Queries" = Table.NestedJoin(#"Renamed Columns10", {"User ID", "Export For"}, #"SAP Internal Resources", {"User ID", "Sales Organisation"}, "SAP Internal Resources", JoinKind.LeftOuter),
		    #"Expanded SAP Internal Resources" = Table.ExpandTableColumn(#"Merged Queries", "SAP Internal Resources", {"Personal Number", "Sales Organisation"}, {"SAP Internal Resources.Personal Number", "SAP Internal Resources.Sales Organisation"}),
		    #"Renamed Columns8" = Table.RenameColumns(#"Expanded SAP Internal Resources",{{"SAP Internal Resources.Personal Number", "Personal Number"}, {"SAP Internal Resources.Sales Organisation", "Sales Organisation New"}}),
		    #"Added Custom15" = Table.AddColumn(#"Renamed Columns8", "Export For Corr", each if [Export For] = "AT45" and [Sales Organisation New] = "DE44" then "DE44" else [Export For]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom15",{"Export For"}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Removed Columns",{{"Export For Corr", "Export For"}}),
		    #"Added Custom14" = Table.AddColumn(#"Renamed Columns6", "Resource Type", each if [Personal Number] <> null then "Internal" else if [User Rate Card] <> "" then "Externals Other Aztech Locations" else "Externals"),
		    #"Merged Queries2" = Table.NestedJoin(#"Added Custom14", {"User Rate Card"}, #"Rate Cards SAP Translation", {"Material Name PPM"}, "Rate Cards SAP Translation", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SAP Translation1" = Table.ExpandTableColumn(#"Merged Queries2", "Rate Cards SAP Translation", {"Material", "Material Name", "Material Name Corrected", "Rate Role"}, {"Rate Cards SAP Translation.Material", "Rate Cards SAP Translation.Material Name", "Rate Cards SAP Translation.Material Name Corrected", "Rate Cards SAP Translation.Rate Role"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Expanded Rate Cards SAP Translation1",{{"Rate Cards SAP Translation.Material Name Corrected", "User Rate Card AT Name"}, {"Rate Cards SAP Translation.Material Name", "User Rate Card SAP Name"}, {"Rate Cards SAP Translation.Material", "User Rate Card Material Number"}, {"Rate Cards SAP Translation.Rate Role", "User Rate Card Rate Role"}}),
		    #"Changed Type10" = Table.TransformColumnTypes(#"Renamed Columns11",{{"Updated on", type datetime}, {"Week starts on", type date}}),
		    #"Appended Query" = Table.Combine({#"Changed Type10", at45_noproductive_jira})
		in
		    #"Appended Query"
	lineageTag: 36714c8f-3d4d-4fb8-8f6a-e36aabfb379a
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'PPM Time Cards All 2025' =
		let
		    Source = Table.Combine({#"PPM Time Cards AT 2025", #"PPM Time Cards SK44 2025", #"PPM Time Cards SK45 2025", #"PPM Time Cards CZ45 2025", #"PPM Time Cards HU44 2025", #"PPM Time Cards DE44 2025"}),
		    #"Replaced Value5" = Table.ReplaceValue(Source,".",",",Replacer.ReplaceText,{"Ext Rate Value"}),
		    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value5",".",",",Replacer.ReplaceText,{"Total", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday", "Actual Hours"}),
		    #"Added Custom" = Table.AddColumn(#"Replaced Value4", "Date 1", each [Week starts on]),
		    #"Added Custom1" = Table.AddColumn(#"Added Custom", "Date 2", each Date.AddDays([Week starts on],1)),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom1", "Date 3", each Date.AddDays([Week starts on],2)),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Date 4", each Date.AddDays([Week starts on],3)),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Date 5", each Date.AddDays([Week starts on],4)),
		    #"Added Custom5" = Table.AddColumn(#"Added Custom4", "Date 6", each Date.AddDays([Week starts on],5)),
		    #"Added Custom6" = Table.AddColumn(#"Added Custom5", "Date 7", each Date.AddDays([Week starts on],6)),
		    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Added Custom6", {"Date 1", "Date 2", "Date 3", "Date 4", "Date 5", "Date 6", "Date 7"}, "Attribute", "Value"),
		    #"Unpivoted Only Selected Columns1" = Table.Unpivot(#"Unpivoted Only Selected Columns", {"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"}, "Attribute.1", "Value.1"),
		    #"Added Custom7" = Table.AddColumn(#"Unpivoted Only Selected Columns1", "Day", each Date.DayOfWeekName([Value],"en-US")),
		    Custom1 = Table.TransformColumnTypes(#"Added Custom7",{{"Value", type date}, {"Day", type text}}),
		    #"Renamed Columns" = Table.RenameColumns(Custom1,{{"Value.1", "TimeN"}, {"Attribute.1", "Day Name"}, {"Day", "Day Name 2"}}),
		    #"Changed Type9" = Table.TransformColumnTypes(#"Renamed Columns",{{"TimeN", type text}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Changed Type9",".",",",Replacer.ReplaceText,{"TimeN"}),
		    #"Changed Type7" = Table.TransformColumnTypes(#"Replaced Value",{{"TimeN", Currency.Type}}),
		    #"Added Custom8" = Table.AddColumn(#"Changed Type7", "CorrectedTime", each if ([Day Name] = [Day Name 2] and [TimeN]<>0)  then [TimeN]/8 else 0),
		    #"Changed Type8" = Table.TransformColumnTypes(#"Added Custom8",{{"CorrectedTime", Currency.Type}}),
		    #"Added Custom9" = Table.AddColumn(#"Changed Type8", "CorrectedMonth", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3)),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom9", "Month Service", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3) & " "& Text.From(Date.Year([Value]))),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom11",{{"CorrectedMonth", type text}}),
		    #"Added Custom12" = Table.AddColumn(#"Changed Type2", "Booking Month", each Text.Middle(Date.MonthName ([Value],"en-US"),0,3)),
		    #"Added Custom10" = Table.AddColumn(#"Added Custom12", "Check", each if [Booking Month] = [CorrectedMonth] then 0 else 1),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom10", each ([CorrectedTime] <> 0)),
		    #"Added Custom13" = Table.AddColumn(#"Filtered Rows", "Total PDs", each [CorrectedTime]),
		    #"Renamed Columns5" = Table.RenameColumns(#"Added Custom13",{{"Value", "Date of Time Booking"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns5",{{"Total PDs", Currency.Type}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type",{"Export Date", "Export For", "Week starts on", "Created", "Project Unit Responsible(Cost Center)", "Department Cost Center", "User", "Project", "Project Name", "Task", "Accounting Element", "Resource plan", "Activity Cluster", "Correction", "State", "Total", "Updated", "Updated by", "Category", "Comments", "CO Rate Role", "SYSID", "Actual Hours", "PPM Pilars", "Department", "RG Pillars", "PM", "PM Dep", "RM", "Accounting Element4", "Project Task Name", "Res Plan Name", "Resource Group", "CO Rate Role2", "AT PD", "User ID", "User ID 2", "Line Manager", "AZ AT User ID", "Debtor", "BillCode", "Company Code", "Project Category", "Vendor Name", "Ext Rate Value", "Date of Time Booking", "TimeN", "Month Service", "Total PDs"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Removed Other Columns","","N/A",Replacer.ReplaceValue,{"Vendor Name"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Replaced Value3",{{"Project Unit Responsible(Cost Center)", "Project Cost Center"}, {"User", "Booked By"}, {"Correction", "Booking Correction"}, {"State", "Booking State"}, {"Updated", "Updated on"}, {"Category", "Booking Category"}, {"Actual Hours", "Actual Hours From Resoure Plan"}, {"Res Plan Name", "Resource Plan Name"}, {"CO Rate Role", "User Rate Card"}, {"User ID", "User ID Long"}, {"User ID 2", "User ID"}, {"Created", "Created on"}, {"Project", "Project Number"}, {"PM Dep", "Project Manager Deputy"}, {"RM", "Resource Manager"}, {"Accounting Element", "Accounting Element and Project Name"}, {"Accounting Element4", "WBS Element"}, {"Total", "Total Booked Hours"}, {"BillCode", "Bill Code"}, {"PM", "Project Manager"}}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1",{"Export Date", "Export For", "Week starts on", "Created on", "Project Manager", "Project Cost Center", "Department Cost Center", "Booked By", "Project Number", "Project Name", "Task", "Resource plan", "Activity Cluster", "Booking Correction", "Booking State", "Updated on", "Updated by", "Booking Category", "Comments", "User Rate Card", "SYSID", "Actual Hours From Resoure Plan", "Project Manager Deputy", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "CO Rate Role2", "AT PD", "User ID", "Line Manager", "Debtor", "Bill Code", "Company Code", "Project Category", "Vendor Name", "Ext Rate Value", "Date of Time Booking", "TimeN", "Month Service", "Total PDs"}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Removed Other Columns1",{{"TimeN", "Total Booked Hours"}}),
		    #"Changed Type6" = Table.TransformColumnTypes(#"Renamed Columns7",{{"Total Booked Hours", Currency.Type}}),
		    #"Grouped Rows" = Table.Group(#"Changed Type6", {"Export Date", "Export For", "Project Manager", "Project Cost Center", "Department Cost Center", "Booked By", "Project Number", "Project Name", "Task", "Resource plan", "Activity Cluster", "Booking Correction", "Booking State", "Booking Category", "Comments", "Actual Hours From Resoure Plan", "Project Manager Deputy", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "CO Rate Role2", "User ID", "Line Manager", "Debtor", "Bill Code", "Company Code", "Month Service", "Project Category", "Ext Rate Value", "Vendor Name", "SYSID", "Date of Time Booking", "Updated on", "Updated by", "Week starts on"}, {{"Total PDs", each List.Sum([Total PDs]), type nullable number}, {"Total Hours", each List.Sum([Total Booked Hours]), type number}}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Grouped Rows",{{"CO Rate Role2", "User Rate Card"}}),
		    #"Reordered Columns" = Table.ReorderColumns(#"Renamed Columns3",{ "Export Date", "Month Service", "Booked By", "User ID", "Booking State", "Total PDs", "Total Hours", "Project Number", "Project Name", "Project Category", "Project Manager", "Project Manager Deputy", "Project Cost Center", "Department Cost Center", "Task", "Resource plan", "Activity Cluster", "Booking Correction",  "Booking Category", "Comments", "Actual Hours From Resoure Plan", "Resource Manager", "WBS Element", "Project Task Name", "Resource Plan Name", "Resource Group", "User Rate Card", "Line Manager", "Debtor", "Bill Code", "Company Code"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Reordered Columns",{{"Export Date", type datetime}}),
		    #"Added Custom16" = Table.AddColumn(#"Changed Type1", "Project / Activity Name", each if [Booking Category] <> "Project/Project Task" then [Booking Category] else [Project Number] & "-" & [Project Name]),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom16",{{"Month Service", type date}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Changed Type3",{{"Month Service", "Month Date"}}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Renamed Columns2",{{"Ext Rate Value", type text}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Changed Type4",".",",",Replacer.ReplaceText,{"Ext Rate Value"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",", ",",",Replacer.ReplaceText,{"Ext Rate Value"}),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Replaced Value2",{{"Ext Rate Value", Currency.Type}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type5",{{"Ext Rate Value", "External Rate"}}),
		    #"Multiplied Column" = Table.TransformColumns(#"Renamed Columns4", {{"External Rate", each _ * 8, Currency.Type}}),
		    #"Merged Queries1" = Table.NestedJoin(#"Multiplied Column", {"User ID"}, #"PPM Deactiveated Users 2025", {"User ID"}, "PPM Deactiveated Users", JoinKind.LeftOuter),
		    #"Expanded PPM Deactiveated Users" = Table.ExpandTableColumn(#"Merged Queries1", "PPM Deactiveated Users", {"User ID Final"}, {"PPM Deactiveated Users.User ID Final"}),
		    #"Renamed Columns9" = Table.RenameColumns(#"Expanded PPM Deactiveated Users",{{"PPM Deactiveated Users.User ID Final", "User ID for Deactivated"}}),
		    #"Added Custom17" = Table.AddColumn(#"Renamed Columns9", "User ID Corrected", each if [User ID for Deactivated] <> null then [User ID for Deactivated] else [User ID]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom17",{"User ID", "User ID for Deactivated"}),
		    #"Renamed Columns10" = Table.RenameColumns(#"Removed Columns1",{{"User ID Corrected", "User ID"}}),
		    #"Changed Type10" = Table.TransformColumnTypes(#"Renamed Columns10",{{"User ID", type text}}),
		    #"Trimmed Text" = Table.TransformColumns(#"Changed Type10",{{"User ID", Text.Trim, type text}}),
		    #"Cleaned Text" = Table.TransformColumns(#"Trimmed Text",{{"User ID", Text.Clean, type text}}),
		    #"Trimmed Text1" = Table.TransformColumns(#"Cleaned Text",{{"Export For", Text.Trim, type text}}),
		    #"Cleaned Text1" = Table.TransformColumns(#"Trimmed Text1",{{"Export For", Text.Clean, type text}}),
		    #"Merged Queries" = Table.NestedJoin(#"Cleaned Text1", {"User ID", "Export For"}, #"SAP Internal Resources", {"User ID", "Sales Organisation"}, "SAP Internal Resources", JoinKind.LeftOuter),
		    #"Expanded SAP Internal Resources" = Table.ExpandTableColumn(#"Merged Queries", "SAP Internal Resources", {"Personal Number", "Sales Organisation"}, {"SAP Internal Resources.Personal Number", "SAP Internal Resources.Sales Organisation"}),
		    #"Renamed Columns8" = Table.RenameColumns(#"Expanded SAP Internal Resources",{{"SAP Internal Resources.Personal Number", "Personal Number"}, {"SAP Internal Resources.Sales Organisation", "Sales Organisation New"}}),
		    #"Added Custom15" = Table.AddColumn(#"Renamed Columns8", "Export For Corr", each if [Export For] = "AT45" and [Sales Organisation New] = "DE44" then "DE44" else [Export For]),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom15",{"Export For"}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Removed Columns",{{"Export For Corr", "Export For"}}),
		    #"Added Custom14" = Table.AddColumn(#"Renamed Columns6", "Resource Type", each if [Personal Number] <> null then "Internal" else if [User Rate Card] <> "" then "Externals Other Aztech Locations" else "Externals"),
		    #"Merged Queries2" = Table.NestedJoin(#"Added Custom14", {"User Rate Card"}, #"Rate Cards SAP Translation", {"Material Name PPM"}, "Rate Cards SAP Translation", JoinKind.LeftOuter),
		    #"Expanded Rate Cards SAP Translation1" = Table.ExpandTableColumn(#"Merged Queries2", "Rate Cards SAP Translation", {"Material", "Material Name", "Material Name Corrected", "Rate Role"}, {"Rate Cards SAP Translation.Material", "Rate Cards SAP Translation.Material Name", "Rate Cards SAP Translation.Material Name Corrected", "Rate Cards SAP Translation.Rate Role"}),
		    #"Renamed Columns11" = Table.RenameColumns(#"Expanded Rate Cards SAP Translation1",{{"Rate Cards SAP Translation.Material Name Corrected", "User Rate Card AT Name"}, {"Rate Cards SAP Translation.Material Name", "User Rate Card SAP Name"}, {"Rate Cards SAP Translation.Material", "User Rate Card Material Number"}, {"Rate Cards SAP Translation.Rate Role", "User Rate Card Rate Role"}})
		in
		    #"Renamed Columns11"
	lineageTag: f9233d33-c80c-4592-8b53-084f397e38fd
	queryGroup: 04_PPM

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression 'Planning Versions' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="PlanningVersions",Kind="Table"]}[Data]
		in
		    GradeandProficiencyLevels_Table
	lineageTag: e840cc56-65d2-41fb-b923-52976efecd23
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Monthly' = ```
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/DE1214-7332185/", [ApiVersion = 15]),
		    #"Filtered Rows3" = Table.SelectRows(Source, each ([Folder Path] <> null)),
		    #"Added Custom11" = Table.AddColumn(#"Filtered Rows3", "FileDate", each Text.Middle([Name],0,8)),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom11",{{"FileDate", type date}}),
		    #"Inserted End of Month" = Table.AddColumn(#"Changed Type3", "End of Month", each Date.EndOfMonth([FileDate]), type datetime),
		    #"Inserted Date" = Table.AddColumn(#"Inserted End of Month", "Date", each DateTime.Date([End of Month]), type date),
		    #"Added Custom3" = Table.AddColumn(#"Inserted Date", "Custom", each DateTime.Date( DateTime.LocalNow())),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom3", "Custom.1", each DateTime.Date( DateTime.LocalNow())),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Date", "Date of Organization"}, {"Custom", "Date of HR"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"End of Month"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns",{{"Date of HR", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"Date of HR", "Date of HR End"}, {"Custom.1", "Date of HR Start"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns1",{{"Date of HR End", type date}}),
		    #"Calculated Start of Month" = Table.TransformColumns(#"Changed Type1",{{"Date of HR Start", Date.StartOfMonth, type date}}),
		    #"Added Custom4" = Table.AddColumn(#"Calculated Start of Month", "Check", each if [Date of Organization] < [Date of HR End] then 1 else 0),
		    #"Filtered Rows2" = Table.SelectRows(#"Added Custom4", each ([Check] = 1)),
		    #"Added Custom1" = Table.AddColumn(#"Filtered Rows2", "Extracted Data", each 
		        let
		            ExcelData = Excel.Workbook([Content], null, true),
		            FirstSheet = ExcelData{0}[Data] // Access the first sheet by index (0-based index)
		        in
		            FirstSheet
		    ),
		    #"Added Custom" = Table.AddColumn(#"Added Custom1", "Service Month", each Date.ToText([Date of Organization],"yyyy","en-US") &Date.ToText([Date of Organization],"MM","en-US")),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each not Text.Contains([Name], "Test")),
		    #"Sorted Rows" = Table.Sort(#"Filtered Rows",{{"Date created", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"Service Month"}),
		    #"Added Custom5" = Table.AddColumn(#"Removed Duplicates", "Custom", each Date.ToText(DateTime.Date( DateTime.LocalNow()),"yyyy","en-US")),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom5",{{"Custom", "Current Year"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns2", "File Year", each Date.ToText([Date of Organization],"yyyy","en-US")),
		    #"Added Custom7" = Table.AddColumn(#"Added Custom6", "Show Org", each if ([Current Year] >= [File Year] and [File Year] <> "2024" ) then 1 else 0),
		    #"Filtered Rows1" = Table.SelectRows(#"Added Custom7", each ([Show Org] = 1)),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Filtered Rows1",{"Extracted Data", "Service Month"}),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Removed Other Columns2", "Extracted Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Extracted Data.Column1", "Extracted Data.Column2", "Extracted Data.Column3", "Extracted Data.Column4", "Extracted Data.Column5", "Extracted Data.Column6", "Extracted Data.Column7", "Extracted Data.Column8", "Extracted Data.Column9", "Extracted Data.Column10", "Extracted Data.Column11", "Extracted Data.Column12", "Extracted Data.Column13", "Extracted Data.Column14", "Extracted Data.Column15", "Extracted Data.Column16", "Extracted Data.Column17", "Extracted Data.Column18", "Extracted Data.Column19", "Extracted Data.Column20", "Extracted Data.Column21", "Extracted Data.Column22", "Extracted Data.Column23", "Extracted Data.Column24", "Extracted Data.Column25", "Extracted Data.Column26", "Extracted Data.Column27", "Extracted Data.Column28"}),
		    #"Removed Errors" = Table.RemoveRowsWithErrors(#"Expanded Extracted Data", {"Extracted Data.Column1"}),
		    #"Added Custom8" = Table.AddColumn(#"Removed Errors", "Service Month New", each if [Extracted Data.Column1] = "Entity" then "Service Month" else [Service Month]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom8",{"Service Month"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns1", [PromoteAllScalars=true]),
		    #"Added Custom9" = Table.AddColumn(#"Promoted Headers", "Org Unit ID Composite", each [Service Month] & "-" & [#"Org Unit ID (Department ID)"]),
		    #"Filtered Rows5" = Table.SelectRows(#"Added Custom9", each [#"Org Unit ID (Department ID)"] <> "Org Unit ID (Department ID)"),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Filtered Rows5",{{"Org Unit ID Composite", type text}}),
		    #"Added Custom10" = Table.AddColumn(#"Changed Type2", "Parent Org Unit ID Composite", each [Service Month] & "-" & [Parent Org Unit ID]),
		    #"Removed Duplicates1" = Table.Distinct(#"Added Custom10", {"Org Unit ID Composite"})
		in
		    #"Removed Duplicates1"
		```
	lineageTag: 520f200c-6877-4d19-8dbc-e7960b146d31
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Last Month' = ```
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/DE1214-7332185/", [ApiVersion = 15]),
		    #"Filtered Rows3" = Table.SelectRows(Source, each ([Folder Path] <> null)),
		    #"Added Custom14" = Table.AddColumn(#"Filtered Rows3", "FileDate", each Text.Middle([Name],0,8)),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom14",{{"FileDate", type date}}),
		    #"Inserted End of Month" = Table.AddColumn(#"Changed Type2", "End of Month", each Date.EndOfMonth([FileDate])),
		    #"Inserted Date" = Table.AddColumn(#"Inserted End of Month", "Date", each DateTime.Date([End of Month]), type date),
		    #"Added Custom3" = Table.AddColumn(#"Inserted Date", "Custom", each DateTime.Date( DateTime.LocalNow())),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom3", "Custom.1", each DateTime.Date( DateTime.LocalNow())),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Date", "Date of Organization"}, {"Custom", "Date of HR"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"End of Month"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns",{{"Date of HR", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"Date of HR", "Date of HR End"}, {"Custom.1", "Date of HR Start"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns1",{{"Date of HR End", type date}}),
		    #"Calculated Start of Month" = Table.TransformColumns(#"Changed Type1",{{"Date of HR Start", Date.StartOfMonth, type date}}),
		        #"Added Custom4" = Table.AddColumn(#"Calculated Start of Month", "Check", each if [Date of Organization] >= Date.AddDays([Date of HR Start], -1) and [Date of Organization] < [Date of HR End] then 1 else 0),
		    #"Filtered Rows2" = Table.SelectRows(#"Added Custom4", each ([Check] = 1)),
		    #"Added Custom1" = Table.AddColumn(#"Filtered Rows2", "Extracted Data", each 
		        let
		            ExcelData = Excel.Workbook([Content], null, true),
		            FirstSheet = ExcelData{0}[Data] // Access the first sheet by index (0-based index)
		        in
		            FirstSheet
		    ),
		    #"Added Custom" = Table.AddColumn(#"Added Custom1", "Service Month", each Date.ToText([Date of Organization],"yyyy","en-US") &Date.ToText([Date of Organization],"MM","en-US")),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each not Text.Contains([Name], "Test")),
		    #"Sorted Rows" = Table.Sort(#"Filtered Rows",{{"Date created", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"Service Month"}),
		    #"Added Custom5" = Table.AddColumn(#"Removed Duplicates", "Custom", each Date.ToText(DateTime.Date( DateTime.LocalNow()),"yyyy","en-US")),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom5",{{"Custom", "Current Year"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns2", "File Year", each Date.ToText([Date of Organization],"yyyy","en-US")),
		    #"Added Custom7" = Table.AddColumn(#"Added Custom6", "Show Org", each if ([Current Year] >= [File Year] and [File Year] <> "2024" ) then 1 else 0),
		    #"Filtered Rows1" = Table.SelectRows(#"Added Custom7", each ([Show Org] = 1)),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Filtered Rows1",{"Extracted Data", "Service Month"}),
		    #"Expanded Extracted Data1" = Table.ExpandTableColumn(#"Removed Other Columns2", "Extracted Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18"}, {"Extracted Data.Column1", "Extracted Data.Column2", "Extracted Data.Column3", "Extracted Data.Column4", "Extracted Data.Column5", "Extracted Data.Column6", "Extracted Data.Column7", "Extracted Data.Column8", "Extracted Data.Column9", "Extracted Data.Column10", "Extracted Data.Column11", "Extracted Data.Column12", "Extracted Data.Column13", "Extracted Data.Column14", "Extracted Data.Column15", "Extracted Data.Column16", "Extracted Data.Column17", "Extracted Data.Column18"}),
		    #"Removed Errors" = Table.RemoveRowsWithErrors(#"Expanded Extracted Data1", {"Extracted Data.Column1"}),
		    #"Added Custom8" = Table.AddColumn(#"Removed Errors", "Service Month New", each if [Extracted Data.Column1] = "Entity" then "Service Month" else [Service Month]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom8",{"Service Month"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns1", [PromoteAllScalars=true]),
		    #"Added Custom10" = Table.AddColumn(#"Promoted Headers", "Current Month", each Date.ToText(DateTime.Date( DateTime.LocalNow()),"yyyy","en-US") & Date.ToText(DateTime.Date( DateTime.LocalNow()),"MM","en-US")),
		    #"Added Custom11" = Table.AddColumn(#"Added Custom10", "Check", each if [Current Month] = [Service Month] then 0 else 1),
		    #"Filtered Rows4" = Table.SelectRows(#"Added Custom11", each [Check] = 1),
		    #"Added Custom12" = Table.AddColumn(#"Filtered Rows4", "Final Service Month", each [Current Month]),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom12",{"Service Month"}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Removed Columns2",{{"Final Service Month", "Service Month"}}),
		    #"Added Custom9" = Table.AddColumn(#"Renamed Columns4", "Org Unit ID Composite", each [Service Month] & "-" & [#"Org Unit ID (Department ID)"]),
		    #"Added Custom13" = Table.AddColumn(#"Added Custom9", "Parent Org Unit ID Composite", each [Service Month] & "-" & [Parent Org Unit ID])
		in
		    #"Added Custom13"
		```
	lineageTag: a251299f-cb9e-4de9-8a60-63c97f1340e7
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Parent Check' =
		let
		    Source = Table.Combine({#"Organizational Unit List Last Month", #"Organizational Unit List Monthly", #"Organizational Unit List Monthly AT Mar", #"Organizational Unit List Monthly AT Feb", #"Organizational Unit List Monthly AT Jan"}),
		    #"Removed Columns" = Table.RemoveColumns(Source,{"Service Month", "Current Month", "Check", "Functional Child Departments - simulated"}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Removed Columns",{"Org Unit ID Composite"}),
		    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns")
		in
		    #"Removed Duplicates"
	lineageTag: 5b0ba784-02af-4262-9baa-71bd5a90e1de
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Monthly AT April' = ```
		let
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/DE1214-7332185/", [ApiVersion = 15]),
		    #"Filtered Rows3" = Table.SelectRows(Source, each ([Folder Path] <> null)),
		    #"Added Custom11" = Table.AddColumn(#"Filtered Rows3", "FileDate", each Text.Middle([Name],0,8)),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom11",{{"FileDate", type date}}),
		    #"Inserted End of Month" = Table.AddColumn(#"Changed Type3", "End of Month", each Date.EndOfMonth([FileDate]), type datetime),
		    #"Inserted Date" = Table.AddColumn(#"Inserted End of Month", "Date", each DateTime.Date([End of Month]), type date),
		    #"Added Custom3" = Table.AddColumn(#"Inserted Date", "Custom", each DateTime.Date( DateTime.LocalNow())),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom3", "Custom.1", each DateTime.Date( DateTime.LocalNow())),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom2",{{"Date", "Date of Organization"}, {"Custom", "Date of HR"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"End of Month"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Columns",{{"Date of HR", type date}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type",{{"Date of HR", "Date of HR End"}, {"Custom.1", "Date of HR Start"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns1",{{"Date of HR End", type date}}),
		    #"Calculated Start of Month" = Table.TransformColumns(#"Changed Type1",{{"Date of HR Start", Date.StartOfMonth, type date}}),
		    #"Added Custom4" = Table.AddColumn(#"Calculated Start of Month", "Check", each if [Date of Organization] <= [Date of HR End] then 1 else 0),
		    #"Filtered Rows2" = Table.SelectRows(#"Added Custom4", each ([Check] = 1)),
		    #"Added Custom1" = Table.AddColumn(#"Filtered Rows2", "Extracted Data", each 
		        let
		            ExcelData = Excel.Workbook([Content], null, true),
		            FirstSheet = ExcelData{0}[Data] // Access the first sheet by index (0-based index)
		        in
		            FirstSheet
		    ),
		    #"Added Custom" = Table.AddColumn(#"Added Custom1", "Service Month", each Date.ToText([Date of Organization],"yyyy","en-US") &Date.ToText([Date of Organization],"MM","en-US")),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each not Text.Contains([Name], "Test")),
		    #"Sorted Rows" = Table.Sort(#"Filtered Rows",{{"Date created", Order.Ascending}}),
		    #"Removed Duplicates" = Table.Distinct(#"Sorted Rows", {"Service Month"}),
		    #"Added Custom5" = Table.AddColumn(#"Removed Duplicates", "Custom", each Date.ToText(DateTime.Date( DateTime.LocalNow()),"yyyy","en-US")),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom5",{{"Custom", "Current Year"}}),
		    #"Added Custom6" = Table.AddColumn(#"Renamed Columns2", "File Year", each Date.ToText([Date of Organization],"yyyy","en-US")),
		    #"Added Custom7" = Table.AddColumn(#"Added Custom6", "Show Org", each if ([Current Year] >= [File Year] and [File Year] <> "2024" ) then 1 else 0),
		    #"Filtered Rows1" = Table.SelectRows(#"Added Custom7", each ([Show Org] = 1)),
		    #"Removed Other Columns2" = Table.SelectColumns(#"Filtered Rows1",{"Extracted Data", "Service Month"}),
		    #"Expanded Extracted Data" = Table.ExpandTableColumn(#"Removed Other Columns2", "Extracted Data", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9", "Column10", "Column11", "Column12", "Column13", "Column14", "Column15", "Column16", "Column17", "Column18", "Column19", "Column20", "Column21", "Column22", "Column23", "Column24", "Column25", "Column26", "Column27", "Column28"}, {"Extracted Data.Column1", "Extracted Data.Column2", "Extracted Data.Column3", "Extracted Data.Column4", "Extracted Data.Column5", "Extracted Data.Column6", "Extracted Data.Column7", "Extracted Data.Column8", "Extracted Data.Column9", "Extracted Data.Column10", "Extracted Data.Column11", "Extracted Data.Column12", "Extracted Data.Column13", "Extracted Data.Column14", "Extracted Data.Column15", "Extracted Data.Column16", "Extracted Data.Column17", "Extracted Data.Column18", "Extracted Data.Column19", "Extracted Data.Column20", "Extracted Data.Column21", "Extracted Data.Column22", "Extracted Data.Column23", "Extracted Data.Column24", "Extracted Data.Column25", "Extracted Data.Column26", "Extracted Data.Column27", "Extracted Data.Column28"}),
		    #"Removed Errors" = Table.RemoveRowsWithErrors(#"Expanded Extracted Data", {"Extracted Data.Column1"}),
		    #"Added Custom8" = Table.AddColumn(#"Removed Errors", "Service Month New", each if [Extracted Data.Column1] = "Entity" then "Service Month" else [Service Month]),
		    #"Removed Columns1" = Table.RemoveColumns(#"Added Custom8",{"Service Month"}),
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Columns1", [PromoteAllScalars=true]),
		    #"Added Custom9" = Table.AddColumn(#"Promoted Headers", "Org Unit ID Composite", each [Service Month] & "-" & [#"Org Unit ID (Department ID)"]),
		    #"Filtered Rows5" = Table.SelectRows(#"Added Custom9", each [#"Org Unit ID (Department ID)"] <> "Org Unit ID (Department ID)"),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Filtered Rows5",{{"Org Unit ID Composite", type text}}),
		    #"Added Custom10" = Table.AddColumn(#"Changed Type2", "Parent Org Unit ID Composite", each [Service Month] & "-" & [Parent Org Unit ID]),
		    #"Removed Duplicates1" = Table.Distinct(#"Added Custom10", {"Org Unit ID Composite"}),
		    #"Filtered Rows4" = Table.SelectRows(#"Removed Duplicates1", each ([Entity] = "Allianz Technology GmbH") and ([In scope for disciplinary view] = "X") and ([Service Month] = "202504"))
		in
		    #"Filtered Rows4"
		```
	lineageTag: a3aad173-6cb5-4412-9289-11a35706ce15
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Monthly AT Jan' =
		let
		    Source = #"Organizational Unit List Monthly AT April",
		    #"Replaced Value" = Table.ReplaceValue(Source,"202504","202501",Replacer.ReplaceText,{"Service Month", "Org Unit ID Composite", "Parent Org Unit ID Composite"})
		in
		    #"Replaced Value"
	lineageTag: 79c5b879-da18-4673-803e-f8e6dad7105f
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Monthly AT Feb' =
		let
		    Source = #"Organizational Unit List Monthly AT April",
		    #"Replaced Value" = Table.ReplaceValue(Source,"202504","202502",Replacer.ReplaceText,{"Service Month", "Org Unit ID Composite", "Parent Org Unit ID Composite"})
		in
		    #"Replaced Value"
	lineageTag: 987738ff-a9ab-48a4-8167-064c6552d37e
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Organizational Unit List Monthly AT Mar' =
		let
		    Source = #"Organizational Unit List Monthly AT April",
		    #"Replaced Value" = Table.ReplaceValue(Source,"202504","202503",Replacer.ReplaceText,{"Entity", "Service Month", "Org Unit ID Composite", "Parent Org Unit ID Composite"})
		in
		    #"Replaced Value"
	lineageTag: 480a69bb-9005-4593-ba92-d754821e43c0
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Supplier List' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/06_Open%20Invoices/2025_OpenInvoicesVendors.XLSX"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(GradeandProficiencyLevels_Table, [PromoteAllScalars=true]),
		    #"Removed Duplicates" = Table.Distinct(#"Promoted Headers", {"Vendor"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Removed Duplicates",{{"CoCd", type text}, {"Vendor", Int64.Type}, {"Name 1", type text}, {"Cty", type text}, {"PO Box pcd", type text}, {"City", type text}, {"Street", type text}, {"Pers.No.", Int64.Type}, {"VAT Registration No.", type text}, {"Tax Number", type text}, {"PayT", type text}, {"DelF", type text}, {"Date", type date}}),
		    #"Renamed Columns" = Table.RenameColumns(#"Changed Type",{{"Vendor", "Supplier"}, {"Name 1", "Supplier Name"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns",{{"Supplier", type text}})
		in
		    #"Changed Type1"
	lineageTag: f2ae1526-09ee-4a2c-b885-008f493fa328
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Document Type' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="DocumentType",Kind="Table"]}[Data]
		in
		    GradeandProficiencyLevels_Table
	lineageTag: f0cae429-defc-433b-a7fc-0030c3952a88
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'GL Accounts' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="GLAccounts",Kind="Table"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(GradeandProficiencyLevels_Table,{{"GL Account", type text}})
		in
		    #"Changed Type"
	lineageTag: d7125f9c-4c43-4538-90e2-1273dd2a9da2
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_sk45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"26f5b2d2-0058-4992-8972-67b1dd22614d" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="26f5b2d2-0058-4992-8972-67b1dd22614d"]}[Data],
		    sys_users_ = #"26f5b2d2-0058-4992-8972-67b1dd22614d"{[entity="sys_users",version=""]}[Data]
		in
		    sys_users_
	lineageTag: dd8b803e-0a38-46ec-85fa-200c7b259fa1
	queryGroup: '04_PPM\PPM-Data Flow-SK45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_sk44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"30a19113-cc31-45d1-8dee-952985df06e0" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="30a19113-cc31-45d1-8dee-952985df06e0"]}[Data],
		    sys_users_ = #"30a19113-cc31-45d1-8dee-952985df06e0"{[entity="sys_users",version=""]}[Data]
		in
		    sys_users_
	lineageTag: 4627d17b-5491-49e8-acd5-d13c3e7f6df2
	queryGroup: '04_PPM\PPM-Data Flow-SK44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_at45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"1ea1bc29-8713-44e9-a93f-1c112f5c6cf2" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="1ea1bc29-8713-44e9-a93f-1c112f5c6cf2"]}[Data],
		    sys_users_ = #"1ea1bc29-8713-44e9-a93f-1c112f5c6cf2"{[entity="sys_users",version=""]}[Data]
		in
		    sys_users_
	lineageTag: 1d1c0996-9b80-4d64-aabe-774f0e179959
	queryGroup: '04_PPM\PPM-Data Flow-AT45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_hu44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"2124d9de-24fe-4856-9e18-68e466c352f2" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="2124d9de-24fe-4856-9e18-68e466c352f2"]}[Data],
		    sys_users_ = #"2124d9de-24fe-4856-9e18-68e466c352f2"{[entity="sys_users",version=""]}[Data]
		in
		    sys_users_
	lineageTag: 937a7b3c-6b20-4074-932f-b6b0e3818768
	queryGroup: '04_PPM\PPM-Data Flow-HU44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_cz45 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"13492ca5-2f39-4630-915f-f63491f4b49d" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="13492ca5-2f39-4630-915f-f63491f4b49d"]}[Data],
		    sys_users_ = #"13492ca5-2f39-4630-915f-f63491f4b49d"{[entity="sys_users",version=""]}[Data]
		in
		    sys_users_
	lineageTag: 91b7e2f5-d7ce-498e-9a07-ed8b2765d363
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_de44 =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3" = Workspaces{[workspaceId="bd777a6f-f8b4-4d15-bcad-2edf46657ec3"]}[Data],
		    #"fa7d4173-0f37-4cd2-a36a-7db5ded13943" = #"bd777a6f-f8b4-4d15-bcad-2edf46657ec3"{[dataflowId="fa7d4173-0f37-4cd2-a36a-7db5ded13943"]}[Data],
		    sys_users_ = #"fa7d4173-0f37-4cd2-a36a-7db5ded13943"{[entity="sys_users",version=""]}[Data],
		    #"Sorted Rows" = Table.Sort(sys_users_,{{"user_name", Order.Ascending}})
		in
		    #"Sorted Rows"
	lineageTag: 3e3ddd30-546f-420a-8838-0e27926a93e6
	queryGroup: '04_PPM\PPM-Data Flow-DE44'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Service Mapping' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="ServiceMapping",Kind="Table"]}[Data],
		    #"Capitalized Each Word" = Table.TransformColumns(GradeandProficiencyLevels_Table,{{"Internal IT Cost", Text.Proper, type text}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Capitalized Each Word",{{"Material", type text}})
		in
		    #"Changed Type"
	lineageTag: ef49a018-5c71-418d-be0d-5fbe8be30e8d
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression sys_users_all =
		let
		    Source = Table.Combine({sys_users_cz45, sys_users_sk45, sys_users_sk44, sys_users_at45, sys_users_hu44, sys_users_de44}),
		    #"Removed Duplicates" = Table.Distinct(Source, {"legal_entity", "user_name"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Duplicates", each ([user_name] <> "")),
		    #"Added Custom" = Table.AddColumn(#"Filtered Rows", "user_name_cleaned", each [user_name]),
		    #"Replaced Value" = Table.ReplaceValue(#"Added Custom","DEACT_","",Replacer.ReplaceText,{"user_name_cleaned"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","_DIS","",Replacer.ReplaceText,{"user_name_cleaned"}),
		    #"Added Custom1" = Table.AddColumn(#"Replaced Value1", "Custom", each if [u_local_logon_name] <> "" then [u_local_logon_name] else [user_name_cleaned]),
		    #"Renamed Columns" = Table.RenameColumns(#"Added Custom1",{{"Custom", "final_user_name"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"user_name_cleaned"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Removed Columns","_PAD01","",Replacer.ReplaceText,{"final_user_name"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","_PAD0","",Replacer.ReplaceText,{"final_user_name"}),
		    #"Removed Duplicates1" = Table.Distinct(#"Replaced Value3", {"sys_id"}),
		    #"Removed Duplicates2" = Table.Distinct(#"Removed Duplicates1", {"final_user_name"}),
		    #"Lowercased Text" = Table.TransformColumns(#"Removed Duplicates2",{{"email", Text.Lower, type text}})
		in
		    #"Lowercased Text"
	lineageTag: ffff370a-20e1-4d95-a1c0-61a28b0bc92b
	queryGroup: '04_PPM\PPM-Data Flow-CZ45'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'OPEX from BAP FC All 2025' =
		let
		    Source = Excel.Workbook(
		        Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Cost%20and%20Revenue/FC/2025_FC_All%20Line%20Items%20BAP%20CEE%20All%20Company%20Codes.xlsx"),
		        null,
		        true
		    ),
		
		    #"Daten BAP 24-03-07_Sheet" = Source{[Item="Sheet1", Kind="Sheet"]}[Data],
		
		    #"Promoted Headers" = Table.PromoteHeaders(#"Daten BAP 24-03-07_Sheet", [PromoteAllScalars = true]),
		    #"Removed Top Rows" = Table.Skip(#"Promoted Headers", 3),
		    #"Removed Columns" = Table.RemoveColumns(#"Removed Top Rows", {"FC-1", "FC-2"}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns", {{"FC-OK", "FC"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns2",{"Refresh Date"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Columns1", each ([FC] <> null)),
		
		    //  Add 12 monthly columns = FC / 12
		    #"Added 12 Months" = List.Accumulate(
		        {1..12},
		        #"Filtered Rows",
		        (state, current) => Table.AddColumn(state, Text.From(current), each try [FC] / 12 otherwise null)
		    ),
		
		    //  Unpivot those 12 month columns
		    #"Unpivoted Months" = Table.Unpivot(
		        #"Added 12 Months",
		        List.Transform({1..12}, each Text.From(_)),
		        "MonthNum",
		        "Amount FC"
		    ),
		
		    //  Create Month Date for 2025
		    #"Added Month Date" = Table.AddColumn(#"Unpivoted Months", "Month Date", each #date(2025, Number.FromText([MonthNum]), 1)),
		
		    #"Added CO Document Number" = Table.AddColumn(#"Added Month Date", "CO Document Number", each ""),
		
		    #"Renamed Columns" = Table.RenameColumns(#"Added CO Document Number", {
		        {"Profit Center Name", "Profit center Name"},
		        {"Profit Center", "Profit center"},
		        {"Cost Center", "Cost object"},
		        {"Cost Center Name", "Cost object Name"}
		    }),
		
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns", {
		        "Company Code", "Company Code Name", "Cost Element", "Cost Element Name",
		        "Profit center", "Profit center Name", "Cost object", "Cost object Name",
		        "WBS Element", "Material", "Material Name", "Debtor", "Debtor Name",
		        "Customer Company Code", "Customer Object", "Amount FC", "Month Date", "CO Document Number", "Version"
		    }),
		
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Other Columns", {
		        {"Debtor Name", "Payer Name"},
		        {"Debtor", "Payer"}
		    }),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns1", "Custom", each List.Max(#"Renamed Columns1"[Version])),
		    #"Removed Columns2" = Table.RemoveColumns(#"Added Custom",{"Version"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns2",{{"Custom", "Version"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns3",{{"Month Date", type date}})
		in
		    #"Changed Type"
	lineageTag: 70de394e-ea9d-4bbd-b932-e92d295d76b0
	queryGroup: '05_SAP BAP'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression at45_nonproductive_itat =
		let
		    // 1 Connect to SharePoint site
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".csv") and ([Name] = "AT45_Overhead IT AT Internal.csv")),
		
		    // 3 Remove hidden/system files
		    VisibleOnly = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		
		    // 4 Get the binary content of the CSV file
		    FileBinary = VisibleOnly{0}[Content],
		
		    // 5 Read CSV content directly
		    CsvImported = Csv.Document(
		        FileBinary,
		        [
		            Delimiter = ",",
		            Encoding = 65001,
		            QuoteStyle = QuoteStyle.None
		        ]
		    ),
		
		    // 6 Promote headers and optionally change types
		    #"Promoted Headers" = Table.PromoteHeaders(CsvImported, [PromoteAllScalars=true]),
		    #"Removed Columns" = Table.RemoveColumns(#"Promoted Headers",{"_2"}),
		    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Removed Columns", {"", "_1"}, "Attribute", "Value"),
		    #"Renamed Columns" = Table.RenameColumns(#"Unpivoted Other Columns",{{"", "employee email"}, {"_1", "activity"}, {"Attribute", "Month"}, {"Value", "Hours"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns",".",",",Replacer.ReplaceText,{"Hours"}),
		    #"Filtered Rows2" = Table.SelectRows(#"Replaced Value", each ([Hours] <> "")),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Filtered Rows2", "activity", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, false), {"activity.1", "activity.2"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Split Column by Delimiter",{"activity.1"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns1",{{"activity.2", "Activity"}}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Renamed Columns1","Chapter PO","Line activities",Replacer.ReplaceText,{"Activity"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","[Service Steering] Learning","Formal Trainings",Replacer.ReplaceText,{"Activity"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Replaced Value2", each ([Month] <> "Feb 2025" and [Month] <> "Jan 2025")),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows1",{{"Month", type date}, {"Hours", Currency.Type}})
		in
		    #"Changed Type"
	lineageTag: cc473c95-7576-4833-a265-e49b3fff657a
	queryGroup: 11_JMP

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression at45_nonproductive_core =
		let
		        // 1 Connect to SharePoint site
		    Source = SharePoint.Files("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each ([Extension] = ".csv") and ([Name] = "AT45_Overhead ABS Core Tracking.csv")),
		
		    // 3 Remove hidden/system files
		    VisibleOnly = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		
		    // 4 Get the binary content of the CSV file
		    FileBinary = VisibleOnly{0}[Content],
		
		    // 5 Read CSV content directly
		    CsvImported = Csv.Document(
		        FileBinary,
		        [
		            Delimiter = ",",
		            Encoding = 65001,
		            QuoteStyle = QuoteStyle.None
		        ]
		    ),
		    #"Removed Top Rows" = Table.Skip(CsvImported,1),
		
		    // 6 Promote headers and optionally change types
		
		    #"Promoted Headers" = Table.PromoteHeaders(#"Removed Top Rows", [PromoteAllScalars=true]),
		    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Promoted Headers", {"", "_1"}, "Attribute", "Value"),
		    #"Renamed Columns" = Table.RenameColumns(#"Unpivoted Other Columns",{{"", "employee email"}, {"_1", "activity"}, {"Attribute", "Month"}, {"Value", "Hours"}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns",".",",",Replacer.ReplaceText,{"Hours"}),
		    #"Filtered Rows2" = Table.SelectRows(#"Replaced Value", each ([Hours] <> "")),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Filtered Rows2", "activity", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, false), {"activity.1", "activity.2"}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Split Column by Delimiter",{"activity.1"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns1",{{"activity.2", "Activity"}}),
		    #"Filtered Rows1" = Table.SelectRows(#"Renamed Columns1", each ([Activity] <> "Absences")),
		    #"Replaced Value1" = Table.ReplaceValue(#"Filtered Rows1","Branch Events-AzTech GmbH","Corporate Events",Replacer.ReplaceText,{"Activity"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Management Support Activities","Line activities",Replacer.ReplaceText,{"Activity"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","Unplanned Core Support (Specific User)","Line activities",Replacer.ReplaceText,{"Activity"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Replaced Value3",{{"Month", type date}, {"Hours", Currency.Type}})
		in
		    #"Changed Type"
	lineageTag: 2f6dcc24-ca5d-4d28-8056-5ac8c9400935
	queryGroup: 11_JMP

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression at45_noproductive_jira =
		let
		    Source = Table.Combine({at45_nonproductive_core, at45_nonproductive_itat}),
		    #"Lowercased Text" = Table.TransformColumns(Source,{{"employee email", Text.Lower, type text}}),
		    #"Merged Queries" = Table.NestedJoin(#"Lowercased Text", {"Month", "employee email"}, #"SAP Internal Resources Changes", {"Month Date", "Email"}, "SAP Internal Resources Changes", JoinKind.LeftOuter),
		    #"Expanded SAP Internal Resources Changes" = Table.ExpandTableColumn(#"Merged Queries", "SAP Internal Resources Changes", {"Personal Number"}, {"Personal Number"}),
		    #"Filtered Rows" = Table.SelectRows(#"Expanded SAP Internal Resources Changes", each [Personal Number] <> null),
		    #"Merged Queries1" = Table.NestedJoin(#"Filtered Rows", {"Personal Number"}, #"SAP Internal Resources", {"Personal Number"}, "SAP Internal Resources", JoinKind.LeftOuter),
		    #"Renamed Columns" = Table.RenameColumns(#"Merged Queries1",{{"Month", "Month Date"}}),
		    #"Expanded SAP Internal Resources" = Table.ExpandTableColumn(#"Renamed Columns", "SAP Internal Resources", {"Employee Name", "My HR Manager", "Sales Organisation", "User ID"}, {"Employee Name", "My HR Manager", "Sales Organisation", "User ID"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Expanded SAP Internal Resources",{{"Employee Name", "Booked By"}, {"Hours", "Total Hours"}}),
		    #"Added Custom" = Table.AddColumn(#"Renamed Columns1", "Total PDs", each [Total Hours]/8),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Custom",{{"Total PDs", Currency.Type}}),
		    #"Added Custom1" = Table.AddColumn(#"Changed Type", "Booking State", each "Processed"),
		    #"Renamed Columns2" = Table.RenameColumns(#"Added Custom1",{{"Activity", "Booking Category"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns2", "Project / Activity Name", each [Booking Category]),
		    #"Added Custom3" = Table.AddColumn(#"Added Custom2", "Date of Time Booking", each [Month Date]),
		    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "Export For", each "AT45"),
		    #"Renamed Columns3" = Table.RenameColumns(#"Added Custom4",{{"Sales Organisation", "Sales Organisation New"}, {"My HR Manager", "Line Manager"}}),
		    #"Added Custom5" = Table.AddColumn(#"Renamed Columns3", "Resource Type", each "Internal"),
		    #"Removed Columns" = Table.RemoveColumns(#"Added Custom5",{"employee email"})
		in
		    #"Removed Columns"
	lineageTag: 5b009e5e-2d62-4e5b-8233-6a1678f74454
	queryGroup: 11_JMP

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Exchange Rates' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/00_Master%20Data/Master%20Domain%20Data.xlsx"), null, true),
		    GradeandProficiencyLevels_Table = Source{[Item="ExchangeRates",Kind="Table"]}[Data]
		in
		    GradeandProficiencyLevels_Table
	lineageTag: ea7c860e-95ca-44a8-842f-fc8d471866d7
	queryGroup: '01_Master Domain Data'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Capex Bookings 2024' =
		let
		    Source = Excel.Workbook(Web.Contents("https://allianzms.sharepoint.com/teams/AT0090-2759670/pbi/Shared%20Documents/01_Power%20BI/Data%20Sources/04_Capex/Capex%20postings%20ALL_2024.XLSX"), null, true),
		    Capex_postings = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Capex_postings, [PromoteAllScalars=true]),
		    #"Filtered Rows" = Table.SelectRows(#"Promoted Headers", each ([Document Date] <> null)),
		    #"Changed Type" = Table.TransformColumnTypes(#"Filtered Rows",{{"Document Date", type date}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Changed Type",{"Amount in local currency", "Local Currency", "Trading partner", "Posting Period", "Year/month", "Cost Element"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Removed Columns", each ([Asset] <> "" and [Asset] <> "*")),
		    #"Renamed Columns" = Table.RenameColumns(#"Filtered Rows1",{{"Text", "Booking Text"}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns",{{"Posting Date", type date}, {"Amount in loc.curr.2", Currency.Type}}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type1",{{"Amount in loc.curr.2", "Amount in EUR"}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Renamed Columns1",{{"Time Stamp", type datetime}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Changed Type2",{"Local Currency 2"}),
		    #"Added Custom" = Table.AddColumn(#"Removed Columns1", "Asset Number", each [Asset]&"/"&[Asset Subnumber]),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Added Custom",{{"Asset Number", type text}}),
		    #"Added Custom1" = Table.AddColumn(#"Changed Type3", "Asset Number Country", each [Company Code]&"-"&[Asset Number]),
		    #"Added Custom2" = Table.AddColumn(#"Added Custom1", "Month Date", each Date.StartOfMonth([Posting Date])),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Added Custom2",{{"Month Date", type date}}),
		    #"Filtered Rows2" = Table.SelectRows(#"Changed Type4", each [Amount in EUR] <> 0)
		in
		    #"Filtered Rows2"
	lineageTag: 44202fd5-13a4-4f77-8025-fc57899702f9
	queryGroup: 07_CAPEX

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

